import{r,j as e}from"./index-OtPSfN_w.js";import{u as J,b as E}from"./components-C9-D01ZZ.js";import{P as z,I as a,b as o,T as s,C as g,c as n,d as C,a as M,B as P}from"./Page-DvMnY4Uh.js";import{L as c}from"./Layout-BvDTjT3E.js";import{B as p,C as N}from"./Banner-DRkmBrND.js";import{S as k}from"./CheckCircleIcon.svg-BdEOQivI.js";import{S as A,D as b,a as R}from"./Divider-DCXs5LYm.js";import{F as I}from"./FormLayout-9MUjKHGm.js";import{S as V}from"./ClockIcon.svg-Dq65wAvQ.js";import"./context-C9td0CMk.js";import"./banner-context-Bfu3e4If.js";function se(){var S,f,v,y,T;const{setting:j}=J(),l=E(),t=E(),[h,D]=r.useState(j.autoUpdateEnabled),[d,w]=r.useState(j.minPricePct.toString()),[x,B]=r.useState(j.notificationEmail||""),[F,m]=r.useState(!1),[$,u]=r.useState(!1);r.useEffect(()=>{var i;if((i=l.data)!=null&&i.success){m(!0);const W=setTimeout(()=>m(!1),3e3);return()=>clearTimeout(W)}},[l.data]),r.useEffect(()=>{if(t.data){u(!0);const i=setTimeout(()=>u(!1),5e3);return()=>clearTimeout(i)}},[t.data]);const L=()=>{const i=new FormData;i.append("autoUpdateEnabled",h.toString()),i.append("minPricePct",d),i.append("notificationEmail",x),l.submit(i,{method:"post"})},U=()=>{t.submit({},{method:"post",action:"/api/test-email"})};return e.jsx(z,{title:"アプリ設定",subtitle:"自動価格調整の設定を管理します",titleMetadata:e.jsx(C,{tone:"info",children:"V2.0"}),children:e.jsxs(c,{children:[F&&e.jsx(c.Section,{children:e.jsx(p,{tone:"success",onDismiss:()=>m(!1),children:e.jsxs(a,{gap:"200",align:"center",children:[e.jsx(o,{source:k,tone:"success"}),e.jsx(s,{children:"設定が正常に保存されました"})]})})}),$&&e.jsx(c.Section,{children:e.jsx(p,{tone:(S=t.data)!=null&&S.success?"success":"critical",onDismiss:()=>u(!1),children:e.jsxs(a,{gap:"200",align:"center",children:[e.jsx(o,{source:k,tone:(f=t.data)!=null&&f.success?"success":"critical"}),e.jsx(s,{children:(v=t.data)!=null&&v.success?`テストメールを送信しました: ${(y=t.data)==null?void 0:y.email}`:`テストメール送信失敗: ${(T=t.data)==null?void 0:T.error}`})]})})}),e.jsx(c.Section,{children:e.jsx(g,{children:e.jsxs(n,{gap:"500",children:[e.jsxs(a,{gap:"300",align:"start",children:[e.jsx(o,{source:A,tone:"base"}),e.jsxs(n,{gap:"200",children:[e.jsx(s,{variant:"headingMd",as:"h2",children:"自動更新設定"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"田中貴金属の価格変動に基づいて商品価格を自動調整します"})]})]}),e.jsx(b,{}),e.jsxs(I,{children:[e.jsxs(a,{gap:"400",align:"start",children:[e.jsx("div",{children:e.jsx(N,{label:"自動更新を有効化",helpText:"有効にすると毎日JST 10:00に自動で価格調整が実行されます",checked:h,onChange:D})}),e.jsx("div",{style:{paddingTop:"24px"},children:e.jsx(C,{tone:h?"info":"warning",children:h?"JST 10:00実行":"無効"})})]}),e.jsx(M,{label:"価格下限設定（%）",type:"number",value:d,onChange:w,min:1,max:100,suffix:"%",helpText:`現在価格の${d}%を下限として保護します（例: ${d}% = ${100-parseInt(d)}%以上下がらない）`})]})]})})}),e.jsx(c.Section,{children:e.jsx(g,{children:e.jsxs(n,{gap:"500",children:[e.jsxs(a,{gap:"300",align:"start",children:[e.jsx(o,{source:R,tone:"base"}),e.jsxs(n,{gap:"200",children:[e.jsx(s,{variant:"headingMd",as:"h2",children:"通知設定"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"価格更新の実行結果やエラーを通知します"})]})]}),e.jsx(b,{}),e.jsxs(I,{children:[e.jsx(M,{label:"通知メールアドレス（任意）",type:"email",value:x,onChange:B,placeholder:"you@example.com",helpText:"設定すると自動更新の結果がメールで通知されます"}),x&&e.jsxs(a,{gap:"200",align:"start",children:[e.jsx(P,{variant:"secondary",size:"medium",onClick:U,loading:t.state==="submitting",disabled:!x,children:"テストメール送信"}),e.jsx("div",{style:{paddingTop:"6px"},children:e.jsx(s,{variant:"bodySm",tone:"subdued",children:"設定したメールアドレスに通知のテストメールを送信します"})})]})]})]})})}),e.jsx(c.Section,{children:e.jsx(g,{children:e.jsxs(n,{gap:"500",children:[e.jsxs(a,{gap:"300",align:"start",children:[e.jsx(o,{source:V,tone:"base"}),e.jsxs(n,{gap:"200",children:[e.jsx(s,{variant:"headingMd",as:"h2",children:"実行スケジュール"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"自動更新の実行タイミングについて"})]})]}),e.jsx(b,{}),e.jsxs(n,{gap:"300",children:[e.jsxs(a,{gap:"600",children:[e.jsxs("div",{children:[e.jsx(s,{variant:"bodyMd",as:"p",fontWeight:"semibold",children:"実行曜日"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"平日（月〜金曜日）"})]}),e.jsxs("div",{children:[e.jsx(s,{variant:"bodyMd",as:"p",fontWeight:"semibold",children:"実行時刻"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"10:00（日本時間）固定"})]}),e.jsxs("div",{children:[e.jsx(s,{variant:"bodyMd",as:"p",fontWeight:"semibold",children:"祝日対応"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"自動的にスキップ"})]})]}),e.jsx(p,{tone:"success",children:e.jsxs(n,{gap:"200",children:[e.jsx(s,{fontWeight:"semibold",children:"🕙 自動更新スケジュール"}),e.jsxs(s,{children:["• ",e.jsx("strong",{children:"実行時刻:"})," JST 10:00（固定）",e.jsx("br",{}),"• ",e.jsx("strong",{children:"対象曜日:"})," 月曜日〜金曜日（平日のみ）",e.jsx("br",{}),"• ",e.jsx("strong",{children:"祝日:"})," 自動的にスキップ",e.jsx("br",{}),"• ",e.jsx("strong",{children:"実行条件:"})," 自動更新が有効で、対象商品が選択されている場合"]})]})})]})]})})}),e.jsx(c.Section,{children:e.jsx(a,{align:"end",children:e.jsx(P,{variant:"primary",size:"large",onClick:L,loading:l.state==="submitting",children:"設定を保存"})})})]})})}export{se as default};
