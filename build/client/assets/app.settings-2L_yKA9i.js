import{r as i,j as e}from"./index-OtPSfN_w.js";import{u as k,b as I}from"./components-C9-D01ZZ.js";import{P as B,I as a,b as x,T as s,C as p,c as n,d as S,a as f,B as D}from"./Page-DvMnY4Uh.js";import{L as r}from"./Layout-BvDTjT3E.js";import{B as u,C as w}from"./Banner-DRkmBrND.js";import{S as F}from"./CheckCircleIcon.svg-BdEOQivI.js";import{S as H,D as m,a as W}from"./Divider-DCXs5LYm.js";import{F as v}from"./FormLayout-9MUjKHGm.js";import{S as L}from"./Select-DS1yuizv.js";import{S as $}from"./ClockIcon.svg-Dq65wAvQ.js";import"./context-C9td0CMk.js";import"./banner-context-Bfu3e4If.js";function X(){const{setting:o}=k(),l=I(),[d,y]=i.useState(o.autoUpdateEnabled),[c,C]=i.useState(o.minPricePct.toString()),[g,E]=i.useState(o.autoUpdateHour.toString()),[b,T]=i.useState(o.notificationEmail||""),[M,j]=i.useState(!1);i.useEffect(()=>{var t;if((t=l.data)!=null&&t.success){j(!0);const h=setTimeout(()=>j(!1),3e3);return()=>clearTimeout(h)}},[l.data]);const P=[...Array(24)].map((t,h)=>({label:`${String(h).padStart(2,"0")}:00`,value:h.toString()})),U=()=>{const t=new FormData;t.append("autoUpdateEnabled",d.toString()),t.append("minPricePct",c),t.append("autoUpdateHour",g),t.append("notificationEmail",b),l.submit(t,{method:"post"})};return e.jsx(B,{title:"アプリ設定",subtitle:"自動価格調整の設定を管理します",titleMetadata:e.jsx(S,{tone:"info",children:"V2.0"}),children:e.jsxs(r,{children:[M&&e.jsx(r.Section,{children:e.jsx(u,{tone:"success",onDismiss:()=>j(!1),children:e.jsxs(a,{gap:"200",align:"center",children:[e.jsx(x,{source:F,tone:"success"}),e.jsx(s,{children:"設定が正常に保存されました"})]})})}),e.jsx(r.Section,{children:e.jsx(p,{children:e.jsxs(n,{gap:"500",children:[e.jsxs(a,{gap:"300",align:"start",children:[e.jsx(x,{source:H,tone:"base"}),e.jsxs(n,{gap:"200",children:[e.jsx(s,{variant:"headingMd",as:"h2",children:"自動更新設定"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"田中貴金属の価格変動に基づいて商品価格を自動調整します"})]})]}),e.jsx(m,{}),e.jsxs(v,{children:[e.jsx(w,{label:"自動更新を有効化",helpText:"有効にすると設定時刻に自動で価格調整が実行されます",checked:d,onChange:y}),e.jsxs(a,{gap:"400",align:"start",children:[e.jsx("div",{style:{minWidth:"200px"},children:e.jsx(L,{label:"自動更新時刻（JST）",options:P,value:g,onChange:E,disabled:!d})}),e.jsx("div",{style:{paddingTop:"24px"},children:e.jsx(S,{tone:d?"info":"warning",children:d?"有効":"無効"})})]}),e.jsx(f,{label:"価格下限設定（%）",type:"number",value:c,onChange:C,min:1,max:100,suffix:"%",helpText:`現在価格の${c}%を下限として保護します（例: ${c}% = ${100-parseInt(c)}%以上下がらない）`})]})]})})}),e.jsx(r.Section,{children:e.jsx(p,{children:e.jsxs(n,{gap:"500",children:[e.jsxs(a,{gap:"300",align:"start",children:[e.jsx(x,{source:W,tone:"base"}),e.jsxs(n,{gap:"200",children:[e.jsx(s,{variant:"headingMd",as:"h2",children:"通知設定"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"価格更新の実行結果やエラーを通知します"})]})]}),e.jsx(m,{}),e.jsx(v,{children:e.jsx(f,{label:"通知メールアドレス（任意）",type:"email",value:b,onChange:T,placeholder:"you@example.com",helpText:"設定すると自動更新の結果がメールで通知されます"})})]})})}),e.jsx(r.Section,{children:e.jsx(p,{children:e.jsxs(n,{gap:"500",children:[e.jsxs(a,{gap:"300",align:"start",children:[e.jsx(x,{source:$,tone:"base"}),e.jsxs(n,{gap:"200",children:[e.jsx(s,{variant:"headingMd",as:"h2",children:"実行スケジュール"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"自動更新の実行タイミングについて"})]})]}),e.jsx(m,{}),e.jsxs(n,{gap:"300",children:[e.jsxs(a,{gap:"600",children:[e.jsxs("div",{children:[e.jsx(s,{variant:"bodyMd",as:"p",fontWeight:"semibold",children:"実行曜日"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"平日（月〜金曜日）"})]}),e.jsxs("div",{children:[e.jsx(s,{variant:"bodyMd",as:"p",fontWeight:"semibold",children:"実行時刻"}),e.jsxs(s,{variant:"bodySm",tone:"subdued",children:[String(o.autoUpdateHour||10).padStart(2,"0"),":00（日本時間）"]})]}),e.jsxs("div",{children:[e.jsx(s,{variant:"bodyMd",as:"p",fontWeight:"semibold",children:"祝日対応"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"自動的にスキップ"})]})]}),e.jsx(u,{tone:"info",children:e.jsxs(s,{children:[e.jsx("strong",{children:"注意:"})," 現在のシステムは平日朝10時（JST）固定で実行されます。 上記の「自動更新時刻」設定は将来の機能向けです。 価格変動がない場合や取得エラー時は更新をスキップします。"]})}),e.jsx(u,{tone:"warning",children:e.jsxs(n,{gap:"200",children:[e.jsx(s,{fontWeight:"semibold",children:"🕙 実際の実行スケジュール（現在）"}),e.jsxs(s,{children:["• ",e.jsx("strong",{children:"実行時刻:"})," 毎平日 朝10:00（日本時間）",e.jsx("br",{}),"• ",e.jsx("strong",{children:"対象曜日:"})," 月曜日〜金曜日",e.jsx("br",{}),"• ",e.jsx("strong",{children:"祝日:"})," 自動的にスキップ",e.jsx("br",{}),"• ",e.jsx("strong",{children:"実行条件:"})," 自動更新が有効で、対象商品が選択されている場合"]})]})})]})]})})}),e.jsx(r.Section,{children:e.jsx(a,{align:"end",children:e.jsx(D,{variant:"primary",size:"large",onClick:U,loading:l.state==="submitting",children:"設定を保存"})})})]})})}export{X as default};
