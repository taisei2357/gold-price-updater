import{r as p,R as d,d as J,j as i}from"./index-OtPSfN_w.js";import{u as ze,A as He,b as Ge}from"./components-CE-OXjA9.js";import{M as Fe,f as F,p as Ve,o as We,s as Ke,y as te,e as L,K as ce,z as de,A as Xe,D as Je,E as qe,F as Ye,v as Qe,T as Pe,j as Te,B as Y,I as E,G as Ee,w as Ze,W as et,H as tt,J as nt,N as De,P as Re,C as _,c as D,d as Q,a as be,b as Ce}from"./Page-CUdf0xBo.js";import{L as R}from"./Layout-CN1seCzE.js";import{S as rt,C as at,B as q}from"./Banner-D_Rcuybh.js";import{a as it,S as st}from"./Select-DHDjkFid.js";import{S as ot}from"./ProductIcon.svg-i01w094n.js";import{D as lt}from"./DataTable-dk25Vxus.js";import{E as ct,p as dt,l as ut}from"./context-C9td0CMk.js";import{S as pt,F as ft}from"./context-Dqc0DVKX.js";import"./banner-context-Bfu3e4If.js";var se={Backdrop:"Polaris-Backdrop",transparent:"Polaris-Backdrop--transparent",belowNavigation:"Polaris-Backdrop--belowNavigation"};function ht(){const t=p.useContext(pt);if(!t)throw new Fe("No ScrollLockManager was provided.");return t}function mt(t){const n=ht();return p.useEffect(()=>(n.registerScrollLock(),()=>{n.unregisterScrollLock()}),[n]),null}function gt(t){const{onClick:n,onTouchStart:s,belowNavigation:e,transparent:r,setClosing:a}=t,o=F(se.Backdrop,e&&se.belowNavigation,r&&se.transparent),l=()=>{a&&a(!0)},c=()=>{a&&a(!1),n&&n()};return d.createElement(d.Fragment,null,d.createElement(mt,null),d.createElement("div",{className:o,onClick:c,onTouchStart:s,onMouseDown:l}))}var xt={InlineGrid:"Polaris-InlineGrid"};function vt({children:t,columns:n,gap:s,alignItems:e}){const r={...We("inline-grid","grid-template-columns",Et(n)),...Ve("inline-grid","gap","space",s),"--pc-inline-grid-align-items":e};return d.createElement("div",{className:xt.InlineGrid,style:Ke(r)},t)}function Et(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.fromEntries(Object.entries(t).map(([n,s])=>[n,je(s)])):je(t)}function je(t){if(t)return typeof t=="number"||!isNaN(Number(t))?`repeat(${Number(t)}, minmax(0, 1fr))`:typeof t=="string"?t:t.map(n=>{switch(n){case"oneThird":return"minmax(0, 1fr)";case"oneHalf":return"minmax(0, 1fr)";case"twoThirds":return"minmax(0, 2fr)"}}).join(" ")}const bt=p.createContext(void 0),Ct=p.memo(function({children:n,disabled:s,root:e}){return p.useEffect(()=>{if(s||!e)return;const r=jt(e)?e.current:e;!r||r.querySelector("[autofocus]")||te(r,!1)},[s,e]),d.createElement(d.Fragment,null,n)});function jt(t){return t.current!==void 0}function Z(){return Z=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var e in s)({}).hasOwnProperty.call(s,e)&&(t[e]=s[e])}return t},Z.apply(null,arguments)}function he(t,n){if(t==null)return{};var s={};for(var e in t)if({}.hasOwnProperty.call(t,e)){if(n.indexOf(e)!==-1)continue;s[e]=t[e]}return s}function ue(t,n){return ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,e){return s.__proto__=e,s},ue(t,n)}function me(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,ue(t,n)}function St(t,n){return t.classList?!!n&&t.classList.contains(n):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+n+" ")!==-1}function yt(t,n){t.classList?t.classList.add(n):St(t,n)||(typeof t.className=="string"?t.className=t.className+" "+n:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+n))}function Se(t,n){return t.replace(new RegExp("(^|\\s)"+n+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function kt(t,n){t.classList?t.classList.remove(n):typeof t.className=="string"?t.className=Se(t.className,n):t.setAttribute("class",Se(t.className&&t.className.baseVal||"",n))}const ye={disabled:!1},ee=d.createContext(null);var Le=function(n){return n.scrollTop},K="unmounted",I="exited",B="entering",z="entered",pe="exiting",N=(function(t){me(n,t);function n(e,r){var a;a=t.call(this,e,r)||this;var o=r,l=o&&!o.isMounting?e.enter:e.appear,c;return a.appearStatus=null,e.in?l?(c=I,a.appearStatus=B):c=z:e.unmountOnExit||e.mountOnEnter?c=K:c=I,a.state={status:c},a.nextCallback=null,a}n.getDerivedStateFromProps=function(r,a){var o=r.in;return o&&a.status===K?{status:I}:null};var s=n.prototype;return s.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},s.componentDidUpdate=function(r){var a=null;if(r!==this.props){var o=this.state.status;this.props.in?o!==B&&o!==z&&(a=B):(o===B||o===z)&&(a=pe)}this.updateStatus(!1,a)},s.componentWillUnmount=function(){this.cancelNextCallback()},s.getTimeouts=function(){var r=this.props.timeout,a,o,l;return a=o=l=r,r!=null&&typeof r!="number"&&(a=r.exit,o=r.enter,l=r.appear!==void 0?r.appear:o),{exit:a,enter:o,appear:l}},s.updateStatus=function(r,a){if(r===void 0&&(r=!1),a!==null)if(this.cancelNextCallback(),a===B){if(this.props.unmountOnExit||this.props.mountOnEnter){var o=this.props.nodeRef?this.props.nodeRef.current:J.findDOMNode(this);o&&Le(o)}this.performEnter(r)}else this.performExit();else this.props.unmountOnExit&&this.state.status===I&&this.setState({status:K})},s.performEnter=function(r){var a=this,o=this.props.enter,l=this.context?this.context.isMounting:r,c=this.props.nodeRef?[l]:[J.findDOMNode(this),l],u=c[0],h=c[1],g=this.getTimeouts(),x=l?g.appear:g.enter;if(!r&&!o||ye.disabled){this.safeSetState({status:z},function(){a.props.onEntered(u)});return}this.props.onEnter(u,h),this.safeSetState({status:B},function(){a.props.onEntering(u,h),a.onTransitionEnd(x,function(){a.safeSetState({status:z},function(){a.props.onEntered(u,h)})})})},s.performExit=function(){var r=this,a=this.props.exit,o=this.getTimeouts(),l=this.props.nodeRef?void 0:J.findDOMNode(this);if(!a||ye.disabled){this.safeSetState({status:I},function(){r.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:pe},function(){r.props.onExiting(l),r.onTransitionEnd(o.exit,function(){r.safeSetState({status:I},function(){r.props.onExited(l)})})})},s.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},s.safeSetState=function(r,a){a=this.setNextCallback(a),this.setState(r,a)},s.setNextCallback=function(r){var a=this,o=!0;return this.nextCallback=function(l){o&&(o=!1,a.nextCallback=null,r(l))},this.nextCallback.cancel=function(){o=!1},this.nextCallback},s.onTransitionEnd=function(r,a){this.setNextCallback(a);var o=this.props.nodeRef?this.props.nodeRef.current:J.findDOMNode(this),l=r==null&&!this.props.addEndListener;if(!o||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var c=this.props.nodeRef?[this.nextCallback]:[o,this.nextCallback],u=c[0],h=c[1];this.props.addEndListener(u,h)}r!=null&&setTimeout(this.nextCallback,r)},s.render=function(){var r=this.state.status;if(r===K)return null;var a=this.props,o=a.children;a.in,a.mountOnEnter,a.unmountOnExit,a.appear,a.enter,a.exit,a.timeout,a.addEndListener,a.onEnter,a.onEntering,a.onEntered,a.onExit,a.onExiting,a.onExited,a.nodeRef;var l=he(a,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return d.createElement(ee.Provider,{value:null},typeof o=="function"?o(r,l):d.cloneElement(d.Children.only(o),l))},n})(d.Component);N.contextType=ee;N.propTypes={};function U(){}N.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:U,onEntering:U,onEntered:U,onExit:U,onExiting:U,onExited:U};N.UNMOUNTED=K;N.EXITED=I;N.ENTERING=B;N.ENTERED=z;N.EXITING=pe;var Nt=function(n,s){return n&&s&&s.split(" ").forEach(function(e){return yt(n,e)})},oe=function(n,s){return n&&s&&s.split(" ").forEach(function(e){return kt(n,e)})},ge=(function(t){me(n,t);function n(){for(var e,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a))||this,e.appliedClasses={appear:{},enter:{},exit:{}},e.onEnter=function(l,c){var u=e.resolveArguments(l,c),h=u[0],g=u[1];e.removeClasses(h,"exit"),e.addClass(h,g?"appear":"enter","base"),e.props.onEnter&&e.props.onEnter(l,c)},e.onEntering=function(l,c){var u=e.resolveArguments(l,c),h=u[0],g=u[1],x=g?"appear":"enter";e.addClass(h,x,"active"),e.props.onEntering&&e.props.onEntering(l,c)},e.onEntered=function(l,c){var u=e.resolveArguments(l,c),h=u[0],g=u[1],x=g?"appear":"enter";e.removeClasses(h,x),e.addClass(h,x,"done"),e.props.onEntered&&e.props.onEntered(l,c)},e.onExit=function(l){var c=e.resolveArguments(l),u=c[0];e.removeClasses(u,"appear"),e.removeClasses(u,"enter"),e.addClass(u,"exit","base"),e.props.onExit&&e.props.onExit(l)},e.onExiting=function(l){var c=e.resolveArguments(l),u=c[0];e.addClass(u,"exit","active"),e.props.onExiting&&e.props.onExiting(l)},e.onExited=function(l){var c=e.resolveArguments(l),u=c[0];e.removeClasses(u,"exit"),e.addClass(u,"exit","done"),e.props.onExited&&e.props.onExited(l)},e.resolveArguments=function(l,c){return e.props.nodeRef?[e.props.nodeRef.current,l]:[l,c]},e.getClassNames=function(l){var c=e.props.classNames,u=typeof c=="string",h=u&&c?c+"-":"",g=u?""+h+l:c[l],x=u?g+"-active":c[l+"Active"],M=u?g+"-done":c[l+"Done"];return{baseClassName:g,activeClassName:x,doneClassName:M}},e}var s=n.prototype;return s.addClass=function(r,a,o){var l=this.getClassNames(a)[o+"ClassName"],c=this.getClassNames("enter"),u=c.doneClassName;a==="appear"&&o==="done"&&u&&(l+=" "+u),o==="active"&&r&&Le(r),l&&(this.appliedClasses[a][o]=l,Nt(r,l))},s.removeClasses=function(r,a){var o=this.appliedClasses[a],l=o.base,c=o.active,u=o.done;this.appliedClasses[a]={},l&&oe(r,l),c&&oe(r,c),u&&oe(r,u)},s.render=function(){var r=this.props;r.classNames;var a=he(r,["classNames"]);return d.createElement(N,Z({},a,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},n})(d.Component);ge.defaultProps={classNames:""};ge.propTypes={};function Mt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xe(t,n){var s=function(a){return n&&p.isValidElement(a)?n(a):a},e=Object.create(null);return t&&p.Children.map(t,function(r){return r}).forEach(function(r){e[r.key]=s(r)}),e}function wt(t,n){t=t||{},n=n||{};function s(h){return h in n?n[h]:t[h]}var e=Object.create(null),r=[];for(var a in t)a in n?r.length&&(e[a]=r,r=[]):r.push(a);var o,l={};for(var c in n){if(e[c])for(o=0;o<e[c].length;o++){var u=e[c][o];l[e[c][o]]=s(u)}l[c]=s(c)}for(o=0;o<r.length;o++)l[r[o]]=s(r[o]);return l}function $(t,n,s){return s[n]!=null?s[n]:t.props[n]}function Ft(t,n){return xe(t.children,function(s){return p.cloneElement(s,{onExited:n.bind(null,s),in:!0,appear:$(s,"appear",t),enter:$(s,"enter",t),exit:$(s,"exit",t)})})}function Pt(t,n,s){var e=xe(t.children),r=wt(n,e);return Object.keys(r).forEach(function(a){var o=r[a];if(p.isValidElement(o)){var l=a in n,c=a in e,u=n[a],h=p.isValidElement(u)&&!u.props.in;c&&(!l||h)?r[a]=p.cloneElement(o,{onExited:s.bind(null,o),in:!0,exit:$(o,"exit",t),enter:$(o,"enter",t)}):!c&&l&&!h?r[a]=p.cloneElement(o,{in:!1}):c&&l&&p.isValidElement(u)&&(r[a]=p.cloneElement(o,{onExited:s.bind(null,o),in:u.props.in,exit:$(o,"exit",t),enter:$(o,"enter",t)}))}}),r}var Tt=Object.values||function(t){return Object.keys(t).map(function(n){return t[n]})},Dt={component:"div",childFactory:function(n){return n}},ve=(function(t){me(n,t);function n(e,r){var a;a=t.call(this,e,r)||this;var o=a.handleExited.bind(Mt(a));return a.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},a}var s=n.prototype;return s.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},s.componentWillUnmount=function(){this.mounted=!1},n.getDerivedStateFromProps=function(r,a){var o=a.children,l=a.handleExited,c=a.firstRender;return{children:c?Ft(r,l):Pt(r,o,l),firstRender:!1}},s.handleExited=function(r,a){var o=xe(this.props.children);r.key in o||(r.props.onExited&&r.props.onExited(a),this.mounted&&this.setState(function(l){var c=Z({},l.children);return delete c[r.key],{children:c}}))},s.render=function(){var r=this.props,a=r.component,o=r.childFactory,l=he(r,["component","childFactory"]),c=this.state.contextValue,u=Tt(this.state.children).map(o);return delete l.appear,delete l.enter,delete l.exit,a===null?d.createElement(ee.Provider,{value:c},u):d.createElement(ee.Provider,{value:c},d.createElement(a,l,u))},n})(d.Component);ve.propTypes={};ve.defaultProps=Dt;var le={Body:"Polaris-Modal__Body",NoScrollBody:"Polaris-Modal__NoScrollBody",IFrame:"Polaris-Modal__IFrame"},ke={Section:"Polaris-Modal-Section",titleHidden:"Polaris-Modal-Section--titleHidden"};function Oe({children:t,flush:n=!1,subdued:s=!1,titleHidden:e=!1}){const r=F(ke.Section,e&&ke.titleHidden);return d.createElement("div",{className:r},d.createElement(L,Object.assign({as:"section",padding:n?"0":"400"},e&&{paddingInlineEnd:"0"},s&&{background:"bg-surface-tertiary"}),t))}var v={Container:"Polaris-Modal-Dialog__Container",Dialog:"Polaris-Modal-Dialog",Modal:"Polaris-Modal-Dialog__Modal",limitHeight:"Polaris-Modal-Dialog--limitHeight",sizeSmall:"Polaris-Modal-Dialog--sizeSmall",sizeLarge:"Polaris-Modal-Dialog--sizeLarge",sizeFullScreen:"Polaris-Modal-Dialog--sizeFullScreen",animateFadeUp:"Polaris-Modal-Dialog--animateFadeUp",entering:"Polaris-Modal-Dialog--entering",exiting:"Polaris-Modal-Dialog--exiting",exited:"Polaris-Modal-Dialog--exited",entered:"Polaris-Modal-Dialog--entered"};function Rt({trapping:t}){const n=p.useContext(ft),s=p.useId();if(!n)throw new Fe("No FocusManager was provided.");const{trapFocusList:e,add:r,remove:a}=n,o=e[0]===s,l=p.useMemo(()=>({canSafelyFocus:o}),[o]);return p.useEffect(()=>{if(t)return r(s),()=>{a(s)}},[r,s,a,t]),l}function Lt({trapping:t=!0,children:n}){const{canSafelyFocus:s}=Rt({trapping:t}),e=p.useRef(null),[r,a]=p.useState(!0);p.useEffect(()=>{const c=s&&!(e.current&&e.current.contains(document.activeElement))?!t:!0;a(c)},[s,t]);const o=c=>{const u=e.current&&e.current.contains(document.activeElement);t===!1||!e.current||u||c.target instanceof Element&&c.target.matches(`${dt.selector} *`)||s&&c.target instanceof HTMLElement&&e.current!==c.target&&!e.current.contains(c.target)&&te(e.current)},l=c=>{if(t===!1||!e.current)return;const u=Xe(e.current),h=Je(e.current);c.target===h&&!c.shiftKey&&(c.preventDefault(),qe(e.current)),c.target===u&&c.shiftKey&&(c.preventDefault(),Ye(e.current))};return d.createElement(Ct,{disabled:r,root:e.current},d.createElement("div",{ref:e},d.createElement(ct,{event:"focusin",handler:o}),d.createElement(ce,{keyCode:de.Tab,keyEvent:"keydown",handler:l}),n))}function Ot({instant:t,labelledBy:n,children:s,limitHeight:e,size:r,onClose:a,onExited:o,onEntered:l,setClosing:c,hasToasts:u,...h}){const g=ut(),x=p.useRef(null),M=p.useContext(bt);let k;M&&(k=M.toastMessages);const H=F(v.Modal,r&&v[Qe("size",r)],e&&v.limitHeight),S=t?N:It;p.useEffect(()=>{x.current&&!x.current.contains(document.activeElement)&&te(x.current)},[]);const w=()=>{c&&c(!0)},O=()=>{c&&c(!1),a()},P=d.createElement("div",{"aria-live":"assertive"},k?k.map(T=>d.createElement(Pe,{visuallyHidden:!0,as:"p",key:T.id},T.content)):null);return d.createElement(S,Object.assign({},h,{nodeRef:x,mountOnEnter:!0,unmountOnExit:!0,timeout:parseInt(g.motion["motion-duration-200"],10),onEntered:l,onExited:o}),d.createElement("div",{className:v.Container,"data-polaris-layer":!0,"data-polaris-overlay":!0,ref:x},d.createElement(Lt,null,d.createElement("div",{role:"dialog","aria-modal":!0,"aria-label":n,"aria-labelledby":n,tabIndex:-1,className:v.Dialog},d.createElement("div",{className:H},d.createElement(ce,{keyCode:de.Escape,keyEvent:"keydown",handler:w}),d.createElement(ce,{keyCode:de.Escape,handler:O}),s),P))))}const At={appear:F(v.animateFadeUp,v.entering),appearActive:F(v.animateFadeUp,v.entered),enter:F(v.animateFadeUp,v.entering),enterActive:F(v.animateFadeUp,v.entered),exit:F(v.animateFadeUp,v.exiting),exitActive:F(v.animateFadeUp,v.exited)};function It({children:t,...n}){return d.createElement(ge,Object.assign({},n,{classNames:At}),t)}function Ne({pressed:t,onClick:n}){const s=Te();return d.createElement(Y,{variant:"tertiary",pressed:t,icon:rt,onClick:n,accessibilityLabel:s.translate("Polaris.Common.close")})}function Bt({id:t,children:n,closing:s,titleHidden:e,onClose:r}){return e||!n?d.createElement(L,{position:"absolute",insetInlineEnd:"400",insetBlockStart:"400",zIndex:"1"},d.createElement(Ne,{onClick:r})):d.createElement(L,{paddingBlockStart:"400",paddingBlockEnd:"400",paddingInlineStart:"400",paddingInlineEnd:"400",borderBlockEndWidth:"025",borderColor:"border",background:"bg-surface-tertiary"},d.createElement(vt,{columns:{xs:"1fr auto"},gap:"400"},d.createElement(E,{gap:"400",blockAlign:"center"},d.createElement(Pe,{id:t,as:"h2",variant:"headingMd",breakWord:!0},n)),d.createElement(Ne,{pressed:s,onClick:r})))}function _t({primaryAction:t,secondaryActions:n,children:s}){const e=t&&Ee(t,{variant:"primary"})||null,r=n&&Ee(n)||null,a=e||r?d.createElement(E,{gap:"200"},r,e):null;return d.createElement(E,{gap:"400",blockAlign:"center"},d.createElement(L,{borderColor:"border",borderBlockStartWidth:"025",padding:"400",width:"100%"},d.createElement(E,{gap:"400",blockAlign:"center",align:"space-between"},d.createElement(L,null,s),a)))}const Me=200,$t=400,fe=function({children:n,title:s,titleHidden:e=!1,src:r,iFrameName:a,open:o,instant:l,sectioned:c,loading:u,size:h,limitHeight:g,footer:x,primaryAction:M,secondaryActions:k,onScrolledToBottom:H,activator:S,activatorWrapper:w="div",onClose:O,onIFrameLoad:P,onTransitionEnd:T,noScroll:ne}){const[re,G]=p.useState(Me),[X,V]=p.useState(!1),f=p.useId(),m=p.useRef(null),C=Te().translate("Polaris.Modal.iFrameTitle");let y,j;const Ae=p.useCallback(()=>{T&&T()},[T]),Ie=p.useCallback(()=>{G(Me);const A=S&&we(S)?S&&S.current:m.current;A&&requestAnimationFrame(()=>te(A))},[S]),Be=p.useCallback(A=>{const W=A.target;if(W&&W.contentWindow)try{G(W.contentWindow.document.body.scrollHeight)}catch{G($t)}P!=null&&P(A)},[P]);if(o){const A=!x&&!M&&!k?null:d.createElement(_t,{primaryAction:M,secondaryActions:k},x),W=c?Ze(n,Oe,{titleHidden:e}):n,ie=u?d.createElement(L,{padding:"400"},d.createElement(E,{gap:"400",align:"center",blockAlign:"center"},d.createElement(De,null))):W,$e=ne?d.createElement("div",{className:le.NoScrollBody},d.createElement(L,{width:"100%",overflowX:"hidden",overflowY:"hidden"},ie)):d.createElement(nt,{shadow:!0,className:le.Body,onScrolledToBottom:H},ie),Ue=r?d.createElement("iframe",{name:a,title:C,src:r,className:le.IFrame,onLoad:Be,style:{height:`${re}px`}}):$e;y=d.createElement(Ot,{instant:l,labelledBy:f,onClose:O,onEntered:Ae,onExited:Ie,size:h,limitHeight:g,setClosing:V},d.createElement(Bt,{titleHidden:e,id:f,closing:X,onClose:O},s),Ue,A),j=d.createElement(gt,{setClosing:V,onClick:O})}const ae=!l,_e=S&&!we(S)?d.createElement(L,{ref:m,as:w},S):null;return d.createElement(et.Provider,{value:!0},_e,d.createElement(tt,{idPrefix:"modal"},d.createElement(ve,{appear:ae,enter:ae,exit:ae},y),j))};function we(t){return Object.prototype.hasOwnProperty.call(t,"current")}fe.Section=Oe;function Ut(t,n,s="all"){let e=t;return s==="k18"&&(e=t.filter(r=>r.title.includes("K18")||r.title.includes("18金"))),n&&(e=e.filter(r=>r.title.toLowerCase().includes(n.toLowerCase())||r.handle.toLowerCase().includes(n.toLowerCase()))),e}function zt(t,n,s=.93){const e=t*(1+n),r=t*s,a=Math.max(e,r);return Math.ceil(a/10)*10}function Ht({products:t,goldPrice:n,selectedProductIds:s,shopSetting:e}){var X,V;const r=Ge(),[a,o]=p.useState([]),[l,c]=p.useState(""),[u,h]=p.useState("all"),[g,x]=p.useState((e==null?void 0:e.minPricePct)||93),[M,k]=p.useState(!1),[H,S]=p.useState([]);p.useEffect(()=>{if(s&&s.length>0){const f=t.filter(m=>s.includes(m.id));o(f)}},[t,s]);const w=Ut(t,l,u),O=p.useCallback((f,m)=>{const b=t.find(C=>C.id===f);o(m?C=>[...C,b]:C=>C.filter(y=>y.id!==f))},[t]),P=p.useCallback(f=>{o(f?w:[])},[w]),T=p.useCallback(()=>{const f=new FormData;f.append("action","saveSelection"),a.forEach(m=>{f.append("productId",m.id)}),r.submit(f,{method:"post"})},[a,r]),ne=p.useCallback(()=>{if(a.length===0||!n)return;const f=a.map(m=>({...m,variants:m.variants.edges.map(b=>{const C=b.node,y=parseFloat(C.price),j=zt(y,n.ratio,g/100);return{...C,currentPrice:y,newPrice:j,priceChange:j-y,changed:j!==y}})}));S(f),k(!0)},[a,n,g]),re=p.useCallback(()=>{if(!n)return;const f=a.map(m=>({...m,variants:m.variants.edges.map(b=>b.node)}));r.submit({action:"updatePrices",selectedProducts:JSON.stringify(f),minPriceRate:g.toString()},{method:"post"}),k(!1)},[a,n,g,r]),G=w.map(f=>{var y;const m=a.some(j=>j.id===f.id),b=f.variants.edges,C=b.length>1?`¥${Math.min(...b.map(j=>parseFloat(j.node.price)))} - ¥${Math.max(...b.map(j=>parseFloat(j.node.price)))}`:`¥${((y=b[0])==null?void 0:y.node.price)||0}`;return[i.jsx(at,{checked:m,onChange:j=>O(f.id,j)}),f.title,i.jsx(Q,{status:f.status==="ACTIVE"?"success":"critical",children:f.status}),C,b.length]});return i.jsx(Re,{title:"商品価格自動調整",subtitle:`${w.length}件の商品（全${t.length}件）`,primaryAction:{content:"価格調整プレビュー",onAction:ne,disabled:a.length===0||!n,loading:r.state==="submitting"},children:i.jsxs(R,{children:[i.jsxs(R.Section,{children:[n&&i.jsxs("div",{style:{background:"linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)",borderRadius:"16px",padding:"24px",color:"white",position:"relative",overflow:"hidden",marginBottom:"20px"},children:[i.jsx("div",{style:{position:"absolute",top:"-30px",right:"-30px",width:"120px",height:"120px",background:"rgba(255,255,255,0.1)",borderRadius:"50%"}}),i.jsxs(E,{align:"space-between",blockAlign:"center",children:[i.jsxs(D,{gap:"300",children:[i.jsxs(E,{gap:"200",blockAlign:"center",children:[i.jsx(Text,{variant:"headingLg",as:"h2",tone:"text-inverse",children:"田中貴金属 金価格"}),i.jsx(Q,{tone:n.changeDirection==="up"?"critical":n.changeDirection==="down"?"success":"info",children:n.changeDirection==="up"?"上昇":n.changeDirection==="down"?"下落":"変動なし"})]}),i.jsxs(E,{gap:"600",children:[i.jsxs("div",{children:[i.jsx(Text,{variant:"bodySm",tone:"text-inverse",children:"店頭小売価格（税込）"}),i.jsx(Text,{variant:"headingXl",as:"p",tone:"text-inverse",children:n.retailPriceFormatted})]}),i.jsxs("div",{children:[i.jsx(Text,{variant:"bodySm",tone:"text-inverse",children:"前日比"}),i.jsx(Text,{variant:"headingLg",as:"p",tone:"text-inverse",children:n.change})]})]}),i.jsx("div",{style:{padding:"16px",background:"rgba(255,255,255,0.2)",borderRadius:"12px",backdropFilter:"blur(10px)"},children:i.jsxs(Text,{variant:"bodyMd",tone:"text-inverse",children:[i.jsxs("strong",{children:["価格調整率: ",n.percentage,"%"]})," — この変動率で商品価格を自動調整"]})})]}),i.jsxs(D,{gap:"200",align:"end",children:[i.jsx(Text,{variant:"bodySm",tone:"text-inverse",children:"最終更新"}),i.jsx(Text,{variant:"bodyMd",tone:"text-inverse",children:new Date(n.lastUpdated).toLocaleString("ja-JP")})]})]})]}),!n&&i.jsx(q,{tone:"critical",children:"金価格情報の取得に失敗しました。価格調整機能をご利用いただけません。"})]}),i.jsx(R.Section,{children:i.jsx(_,{children:i.jsx("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)",padding:"24px",borderRadius:"12px",marginBottom:"20px"},children:i.jsxs(D,{gap:"400",children:[i.jsx(Text,{variant:"headingMd",as:"h3",children:"商品検索・選択"}),i.jsxs(E,{gap:"400",children:[i.jsx("div",{style:{flex:1},children:i.jsx(be,{label:"商品検索",value:l,onChange:c,placeholder:"商品名またはハンドルで検索...",clearButton:!0,onClearButtonClick:()=>c("")})}),i.jsx("div",{style:{minWidth:"150px"},children:i.jsx(it,{label:"商品フィルター",options:[{label:"すべての商品",value:"all"},{label:"K18商品のみ",value:"k18"}],value:u,onChange:h})})]}),i.jsx("div",{style:{background:"white",padding:"20px",borderRadius:"8px",border:"1px solid #e2e8f0"},children:i.jsx(be,{label:"価格下限設定 (%)",type:"number",value:g.toString(),onChange:f=>x(parseInt(f)||93),suffix:"%",helpText:"現在価格に対する最低価格の割合（例: 93% = 7%以上は下がらない）",min:"50",max:"100"})}),i.jsxs(E,{gap:"300",children:[i.jsx(Y,{onClick:()=>P(!0),disabled:w.length===0,size:"large",children:"すべて選択"}),i.jsx(Y,{onClick:()=>P(!1),disabled:a.length===0,size:"large",children:"選択解除"}),i.jsx(Y,{onClick:T,disabled:r.state==="submitting",variant:"primary",size:"large",children:"選択を保存"})]}),s&&s.length>0&&i.jsx("div",{style:{background:"#e0f2fe",padding:"16px",borderRadius:"8px",border:"1px solid #0ea5e9"},children:i.jsxs(E,{gap:"200",blockAlign:"center",children:[i.jsx(Ce,{source:ot,tone:"info"}),i.jsxs(Text,{variant:"bodyMd",children:["現在 ",i.jsxs("strong",{children:[s.length,"件"]})," の商品が自動更新対象として保存されています"]})]})}),((X=r.data)==null?void 0:X.message)&&i.jsx("div",{style:{background:"#dcfce7",padding:"16px",borderRadius:"8px",border:"1px solid #10b981"},children:i.jsxs(E,{gap:"200",blockAlign:"center",children:[i.jsx(Ce,{source:st,tone:"success"}),i.jsx(Text,{variant:"bodyMd",tone:"success",children:r.data.message})]})})]})})})}),i.jsx(R.Section,{children:i.jsx(_,{children:i.jsx(lt,{columnContentTypes:["text","text","text","text","numeric"],headings:["選択","商品名","ステータス","価格","バリエーション"],rows:G,pagination:{hasNext:!1,hasPrevious:!1}})})}),i.jsx(fe,{open:M,onClose:()=>k(!1),title:"価格調整プレビュー",primaryAction:{content:"価格を更新",onAction:re,loading:r.state==="submitting"},secondaryActions:[{content:"キャンセル",onAction:()=>k(!1)}],large:!0,children:i.jsx(fe.Section,{children:i.jsx(D,{gap:"400",children:H.map(f=>i.jsx(_,{children:i.jsxs(D,{gap:"300",children:[i.jsx("h4",{children:f.title}),f.variants.map(m=>i.jsxs(E,{align:"space-between",children:[i.jsx("span",{children:m.title||"デフォルト"}),i.jsxs(E,{gap:"200",children:[i.jsxs("span",{children:["¥",m.currentPrice," → ¥",m.newPrice]}),m.changed&&i.jsxs(Q,{tone:m.priceChange>0?"warning":"success",children:[m.priceChange>0?"+":"",m.priceChange,"円"]})]})]},m.id))]})},f.id))})})}),((V=r.data)==null?void 0:V.updateResults)&&i.jsx(R.Section,{children:i.jsx(_,{children:i.jsxs(D,{gap:"400",children:[i.jsx("h3",{children:"価格更新結果"}),r.data.summary&&i.jsx(_,{background:"bg-surface-secondary",children:i.jsxs(E,{gap:"400",children:[i.jsxs("div",{children:["合計: ",i.jsx("strong",{children:r.data.summary.total}),"件"]}),i.jsxs("div",{children:["成功: ",i.jsx("strong",{style:{color:"green"},children:r.data.summary.success}),"件"]}),i.jsxs("div",{children:["失敗: ",i.jsx("strong",{style:{color:"red"},children:r.data.summary.failed}),"件"]})]})}),r.data.error&&i.jsx(q,{tone:"critical",children:r.data.error}),r.data.message&&i.jsx(q,{tone:"info",children:r.data.message}),r.data.updateResults.map((f,m)=>{var b,C;return i.jsx(q,{tone:f.success?"success":"critical",children:f.success?`${f.product} - ${f.variant}: ¥${(b=f.oldPrice)==null?void 0:b.toLocaleString()} → ¥${(C=f.newPrice)==null?void 0:C.toLocaleString()}`:`${f.product} - ${f.variant}: ${f.error}`},m)})]})})})]})})}function tn(){const t=ze(),{goldPrice:n,selectedProductIds:s,shopSetting:e}=t;return i.jsx(p.Suspense,{fallback:i.jsx(Re,{title:"商品価格自動調整",subtitle:"読み込み中...",children:i.jsxs(R,{children:[i.jsx(R.Section,{children:n&&i.jsx(_,{children:i.jsxs(D,{gap:"400",children:[i.jsxs(E,{align:"space-between",children:[i.jsx("h3",{children:"田中貴金属 金価格情報"}),i.jsx(Q,{tone:n.changeDirection==="up"?"attention":n.changeDirection==="down"?"success":"info",children:n.changeDirection==="up"?"上昇":n.changeDirection==="down"?"下落":"変動なし"})]}),i.jsxs(E,{gap:"600",children:[i.jsxs("div",{children:[i.jsx("p",{style:{color:"#6B7280",fontSize:"14px"},children:"店頭小売価格（税込）"}),i.jsx("p",{style:{fontSize:"18px",fontWeight:"bold"},children:n.retailPriceFormatted})]}),i.jsxs("div",{children:[i.jsx("p",{style:{color:"#6B7280",fontSize:"14px"},children:"前日比"}),i.jsx("p",{style:{fontSize:"18px",fontWeight:"bold",color:n.changeDirection==="up"?"#DC2626":n.changeDirection==="down"?"#059669":"#6B7280"},children:n.change})]})]}),i.jsx("div",{style:{padding:"12px",backgroundColor:"#F3F4F6",borderRadius:"8px"},children:i.jsxs("p",{style:{margin:0},children:[i.jsxs("strong",{children:["価格調整率: ",n.percentage,"%"]}),"（この変動率で商品価格を自動調整します）"]})}),i.jsxs("p",{style:{color:"#6B7280",fontSize:"12px",margin:0},children:["最終更新: ",new Date(n.lastUpdated).toLocaleString("ja-JP")]})]})})}),i.jsx(R.Section,{children:i.jsx(_,{children:i.jsx(D,{gap:"400",children:i.jsxs("div",{style:{textAlign:"center",padding:"60px 20px"},children:[i.jsx(De,{size:"large"}),i.jsx("p",{style:{marginTop:"20px",color:"#6B7280"},children:"商品データを読み込んでいます..."})]})})})})]})}),children:i.jsx(He,{resolve:t.products,children:r=>i.jsx(Ht,{products:r,goldPrice:n,selectedProductIds:s,shopSetting:e})})})}export{tn as default};
