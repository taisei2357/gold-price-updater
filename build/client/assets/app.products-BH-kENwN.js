import{r as p,R as d,d as q,j as i}from"./index-OtPSfN_w.js";import{u as Ue,A as He,b as Ge}from"./components-CE-OXjA9.js";import{M as Pe,f as F,p as Ve,o as ze,s as We,y as te,e as L,K as ce,z as de,A as Ke,D as Xe,E as Je,F as qe,v as Ye,T as Fe,j as we,B as Y,I as j,G as ve,w as Qe,W as Ze,H as et,J as tt,N as De,P as Te,C as T,c as $,d as Q,a as Ce}from"./Page-CUdf0xBo.js";import{L as O}from"./Layout-CN1seCzE.js";import{S as nt,C as at,B as U}from"./Banner-D_Rcuybh.js";import{S as rt}from"./Select-B40Z_D3S.js";import{D as st}from"./DataTable-dk25Vxus.js";import{E as it,p as ot,l as lt}from"./context-C9td0CMk.js";import{S as ct,F as dt}from"./context-Dqc0DVKX.js";import"./banner-context-Bfu3e4If.js";var ie={Backdrop:"Polaris-Backdrop",transparent:"Polaris-Backdrop--transparent",belowNavigation:"Polaris-Backdrop--belowNavigation"};function ut(){const t=p.useContext(ct);if(!t)throw new Pe("No ScrollLockManager was provided.");return t}function pt(t){const a=ut();return p.useEffect(()=>(a.registerScrollLock(),()=>{a.unregisterScrollLock()}),[a]),null}function ft(t){const{onClick:a,onTouchStart:s,belowNavigation:e,transparent:n,setClosing:r}=t,o=F(ie.Backdrop,e&&ie.belowNavigation,n&&ie.transparent),l=()=>{r&&r(!0)},c=()=>{r&&r(!1),a&&a()};return d.createElement(d.Fragment,null,d.createElement(pt,null),d.createElement("div",{className:o,onClick:c,onTouchStart:s,onMouseDown:l}))}var ht={InlineGrid:"Polaris-InlineGrid"};function mt({children:t,columns:a,gap:s,alignItems:e}){const n={...ze("inline-grid","grid-template-columns",gt(a)),...Ve("inline-grid","gap","space",s),"--pc-inline-grid-align-items":e};return d.createElement("div",{className:ht.InlineGrid,style:We(n)},t)}function gt(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.fromEntries(Object.entries(t).map(([a,s])=>[a,be(s)])):be(t)}function be(t){if(t)return typeof t=="number"||!isNaN(Number(t))?`repeat(${Number(t)}, minmax(0, 1fr))`:typeof t=="string"?t:t.map(a=>{switch(a){case"oneThird":return"minmax(0, 1fr)";case"oneHalf":return"minmax(0, 1fr)";case"twoThirds":return"minmax(0, 2fr)"}}).join(" ")}const xt=p.createContext(void 0),Et=p.memo(function({children:a,disabled:s,root:e}){return p.useEffect(()=>{if(s||!e)return;const n=vt(e)?e.current:e;!n||n.querySelector("[autofocus]")||te(n,!1)},[s,e]),d.createElement(d.Fragment,null,a)});function vt(t){return t.current!==void 0}function Z(){return Z=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var e in s)({}).hasOwnProperty.call(s,e)&&(t[e]=s[e])}return t},Z.apply(null,arguments)}function he(t,a){if(t==null)return{};var s={};for(var e in t)if({}.hasOwnProperty.call(t,e)){if(a.indexOf(e)!==-1)continue;s[e]=t[e]}return s}function ue(t,a){return ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,e){return s.__proto__=e,s},ue(t,a)}function me(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t,ue(t,a)}function Ct(t,a){return t.classList?!!a&&t.classList.contains(a):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+a+" ")!==-1}function bt(t,a){t.classList?t.classList.add(a):Ct(t,a)||(typeof t.className=="string"?t.className=t.className+" "+a:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+a))}function je(t,a){return t.replace(new RegExp("(^|\\s)"+a+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function jt(t,a){t.classList?t.classList.remove(a):typeof t.className=="string"?t.className=je(t.className,a):t.setAttribute("class",je(t.className&&t.className.baseVal||"",a))}const Se={disabled:!1},ee=d.createContext(null);var Oe=function(a){return a.scrollTop},X="unmounted",R="exited",_="entering",G="entered",pe="exiting",k=(function(t){me(a,t);function a(e,n){var r;r=t.call(this,e,n)||this;var o=n,l=o&&!o.isMounting?e.enter:e.appear,c;return r.appearStatus=null,e.in?l?(c=R,r.appearStatus=_):c=G:e.unmountOnExit||e.mountOnEnter?c=X:c=R,r.state={status:c},r.nextCallback=null,r}a.getDerivedStateFromProps=function(n,r){var o=n.in;return o&&r.status===X?{status:R}:null};var s=a.prototype;return s.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},s.componentDidUpdate=function(n){var r=null;if(n!==this.props){var o=this.state.status;this.props.in?o!==_&&o!==G&&(r=_):(o===_||o===G)&&(r=pe)}this.updateStatus(!1,r)},s.componentWillUnmount=function(){this.cancelNextCallback()},s.getTimeouts=function(){var n=this.props.timeout,r,o,l;return r=o=l=n,n!=null&&typeof n!="number"&&(r=n.exit,o=n.enter,l=n.appear!==void 0?n.appear:o),{exit:r,enter:o,appear:l}},s.updateStatus=function(n,r){if(n===void 0&&(n=!1),r!==null)if(this.cancelNextCallback(),r===_){if(this.props.unmountOnExit||this.props.mountOnEnter){var o=this.props.nodeRef?this.props.nodeRef.current:q.findDOMNode(this);o&&Oe(o)}this.performEnter(n)}else this.performExit();else this.props.unmountOnExit&&this.state.status===R&&this.setState({status:X})},s.performEnter=function(n){var r=this,o=this.props.enter,l=this.context?this.context.isMounting:n,c=this.props.nodeRef?[l]:[q.findDOMNode(this),l],u=c[0],h=c[1],g=this.getTimeouts(),x=l?g.appear:g.enter;if(!n&&!o||Se.disabled){this.safeSetState({status:G},function(){r.props.onEntered(u)});return}this.props.onEnter(u,h),this.safeSetState({status:_},function(){r.props.onEntering(u,h),r.onTransitionEnd(x,function(){r.safeSetState({status:G},function(){r.props.onEntered(u,h)})})})},s.performExit=function(){var n=this,r=this.props.exit,o=this.getTimeouts(),l=this.props.nodeRef?void 0:q.findDOMNode(this);if(!r||Se.disabled){this.safeSetState({status:R},function(){n.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:pe},function(){n.props.onExiting(l),n.onTransitionEnd(o.exit,function(){n.safeSetState({status:R},function(){n.props.onExited(l)})})})},s.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},s.safeSetState=function(n,r){r=this.setNextCallback(r),this.setState(n,r)},s.setNextCallback=function(n){var r=this,o=!0;return this.nextCallback=function(l){o&&(o=!1,r.nextCallback=null,n(l))},this.nextCallback.cancel=function(){o=!1},this.nextCallback},s.onTransitionEnd=function(n,r){this.setNextCallback(r);var o=this.props.nodeRef?this.props.nodeRef.current:q.findDOMNode(this),l=n==null&&!this.props.addEndListener;if(!o||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var c=this.props.nodeRef?[this.nextCallback]:[o,this.nextCallback],u=c[0],h=c[1];this.props.addEndListener(u,h)}n!=null&&setTimeout(this.nextCallback,n)},s.render=function(){var n=this.state.status;if(n===X)return null;var r=this.props,o=r.children;r.in,r.mountOnEnter,r.unmountOnExit,r.appear,r.enter,r.exit,r.timeout,r.addEndListener,r.onEnter,r.onEntering,r.onEntered,r.onExit,r.onExiting,r.onExited,r.nodeRef;var l=he(r,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return d.createElement(ee.Provider,{value:null},typeof o=="function"?o(n,l):d.cloneElement(d.Children.only(o),l))},a})(d.Component);k.contextType=ee;k.propTypes={};function H(){}k.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:H,onEntering:H,onEntered:H,onExit:H,onExiting:H,onExited:H};k.UNMOUNTED=X;k.EXITED=R;k.ENTERING=_;k.ENTERED=G;k.EXITING=pe;var St=function(a,s){return a&&s&&s.split(" ").forEach(function(e){return bt(a,e)})},oe=function(a,s){return a&&s&&s.split(" ").forEach(function(e){return jt(a,e)})},ge=(function(t){me(a,t);function a(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,e.appliedClasses={appear:{},enter:{},exit:{}},e.onEnter=function(l,c){var u=e.resolveArguments(l,c),h=u[0],g=u[1];e.removeClasses(h,"exit"),e.addClass(h,g?"appear":"enter","base"),e.props.onEnter&&e.props.onEnter(l,c)},e.onEntering=function(l,c){var u=e.resolveArguments(l,c),h=u[0],g=u[1],x=g?"appear":"enter";e.addClass(h,x,"active"),e.props.onEntering&&e.props.onEntering(l,c)},e.onEntered=function(l,c){var u=e.resolveArguments(l,c),h=u[0],g=u[1],x=g?"appear":"enter";e.removeClasses(h,x),e.addClass(h,x,"done"),e.props.onEntered&&e.props.onEntered(l,c)},e.onExit=function(l){var c=e.resolveArguments(l),u=c[0];e.removeClasses(u,"appear"),e.removeClasses(u,"enter"),e.addClass(u,"exit","base"),e.props.onExit&&e.props.onExit(l)},e.onExiting=function(l){var c=e.resolveArguments(l),u=c[0];e.addClass(u,"exit","active"),e.props.onExiting&&e.props.onExiting(l)},e.onExited=function(l){var c=e.resolveArguments(l),u=c[0];e.removeClasses(u,"exit"),e.addClass(u,"exit","done"),e.props.onExited&&e.props.onExited(l)},e.resolveArguments=function(l,c){return e.props.nodeRef?[e.props.nodeRef.current,l]:[l,c]},e.getClassNames=function(l){var c=e.props.classNames,u=typeof c=="string",h=u&&c?c+"-":"",g=u?""+h+l:c[l],x=u?g+"-active":c[l+"Active"],M=u?g+"-done":c[l+"Done"];return{baseClassName:g,activeClassName:x,doneClassName:M}},e}var s=a.prototype;return s.addClass=function(n,r,o){var l=this.getClassNames(r)[o+"ClassName"],c=this.getClassNames("enter"),u=c.doneClassName;r==="appear"&&o==="done"&&u&&(l+=" "+u),o==="active"&&n&&Oe(n),l&&(this.appliedClasses[r][o]=l,St(n,l))},s.removeClasses=function(n,r){var o=this.appliedClasses[r],l=o.base,c=o.active,u=o.done;this.appliedClasses[r]={},l&&oe(n,l),c&&oe(n,c),u&&oe(n,u)},s.render=function(){var n=this.props;n.classNames;var r=he(n,["classNames"]);return d.createElement(k,Z({},r,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},a})(d.Component);ge.defaultProps={classNames:""};ge.propTypes={};function Nt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xe(t,a){var s=function(r){return a&&p.isValidElement(r)?a(r):r},e=Object.create(null);return t&&p.Children.map(t,function(n){return n}).forEach(function(n){e[n.key]=s(n)}),e}function yt(t,a){t=t||{},a=a||{};function s(h){return h in a?a[h]:t[h]}var e=Object.create(null),n=[];for(var r in t)r in a?n.length&&(e[r]=n,n=[]):n.push(r);var o,l={};for(var c in a){if(e[c])for(o=0;o<e[c].length;o++){var u=e[c][o];l[e[c][o]]=s(u)}l[c]=s(c)}for(o=0;o<n.length;o++)l[n[o]]=s(n[o]);return l}function B(t,a,s){return s[a]!=null?s[a]:t.props[a]}function kt(t,a){return xe(t.children,function(s){return p.cloneElement(s,{onExited:a.bind(null,s),in:!0,appear:B(s,"appear",t),enter:B(s,"enter",t),exit:B(s,"exit",t)})})}function Mt(t,a,s){var e=xe(t.children),n=yt(a,e);return Object.keys(n).forEach(function(r){var o=n[r];if(p.isValidElement(o)){var l=r in a,c=r in e,u=a[r],h=p.isValidElement(u)&&!u.props.in;c&&(!l||h)?n[r]=p.cloneElement(o,{onExited:s.bind(null,o),in:!0,exit:B(o,"exit",t),enter:B(o,"enter",t)}):!c&&l&&!h?n[r]=p.cloneElement(o,{in:!1}):c&&l&&p.isValidElement(u)&&(n[r]=p.cloneElement(o,{onExited:s.bind(null,o),in:u.props.in,exit:B(o,"exit",t),enter:B(o,"enter",t)}))}}),n}var Pt=Object.values||function(t){return Object.keys(t).map(function(a){return t[a]})},Ft={component:"div",childFactory:function(a){return a}},Ee=(function(t){me(a,t);function a(e,n){var r;r=t.call(this,e,n)||this;var o=r.handleExited.bind(Nt(r));return r.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},r}var s=a.prototype;return s.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},s.componentWillUnmount=function(){this.mounted=!1},a.getDerivedStateFromProps=function(n,r){var o=r.children,l=r.handleExited,c=r.firstRender;return{children:c?kt(n,l):Mt(n,o,l),firstRender:!1}},s.handleExited=function(n,r){var o=xe(this.props.children);n.key in o||(n.props.onExited&&n.props.onExited(r),this.mounted&&this.setState(function(l){var c=Z({},l.children);return delete c[n.key],{children:c}}))},s.render=function(){var n=this.props,r=n.component,o=n.childFactory,l=he(n,["component","childFactory"]),c=this.state.contextValue,u=Pt(this.state.children).map(o);return delete l.appear,delete l.enter,delete l.exit,r===null?d.createElement(ee.Provider,{value:c},u):d.createElement(ee.Provider,{value:c},d.createElement(r,l,u))},a})(d.Component);Ee.propTypes={};Ee.defaultProps=Ft;var le={Body:"Polaris-Modal__Body",NoScrollBody:"Polaris-Modal__NoScrollBody",IFrame:"Polaris-Modal__IFrame"},Ne={Section:"Polaris-Modal-Section",titleHidden:"Polaris-Modal-Section--titleHidden"};function Le({children:t,flush:a=!1,subdued:s=!1,titleHidden:e=!1}){const n=F(Ne.Section,e&&Ne.titleHidden);return d.createElement("div",{className:n},d.createElement(L,Object.assign({as:"section",padding:a?"0":"400"},e&&{paddingInlineEnd:"0"},s&&{background:"bg-surface-tertiary"}),t))}var E={Container:"Polaris-Modal-Dialog__Container",Dialog:"Polaris-Modal-Dialog",Modal:"Polaris-Modal-Dialog__Modal",limitHeight:"Polaris-Modal-Dialog--limitHeight",sizeSmall:"Polaris-Modal-Dialog--sizeSmall",sizeLarge:"Polaris-Modal-Dialog--sizeLarge",sizeFullScreen:"Polaris-Modal-Dialog--sizeFullScreen",animateFadeUp:"Polaris-Modal-Dialog--animateFadeUp",entering:"Polaris-Modal-Dialog--entering",exiting:"Polaris-Modal-Dialog--exiting",exited:"Polaris-Modal-Dialog--exited",entered:"Polaris-Modal-Dialog--entered"};function wt({trapping:t}){const a=p.useContext(dt),s=p.useId();if(!a)throw new Pe("No FocusManager was provided.");const{trapFocusList:e,add:n,remove:r}=a,o=e[0]===s,l=p.useMemo(()=>({canSafelyFocus:o}),[o]);return p.useEffect(()=>{if(t)return n(s),()=>{r(s)}},[n,s,r,t]),l}function Dt({trapping:t=!0,children:a}){const{canSafelyFocus:s}=wt({trapping:t}),e=p.useRef(null),[n,r]=p.useState(!0);p.useEffect(()=>{const c=s&&!(e.current&&e.current.contains(document.activeElement))?!t:!0;r(c)},[s,t]);const o=c=>{const u=e.current&&e.current.contains(document.activeElement);t===!1||!e.current||u||c.target instanceof Element&&c.target.matches(`${ot.selector} *`)||s&&c.target instanceof HTMLElement&&e.current!==c.target&&!e.current.contains(c.target)&&te(e.current)},l=c=>{if(t===!1||!e.current)return;const u=Ke(e.current),h=Xe(e.current);c.target===h&&!c.shiftKey&&(c.preventDefault(),Je(e.current)),c.target===u&&c.shiftKey&&(c.preventDefault(),qe(e.current))};return d.createElement(Et,{disabled:n,root:e.current},d.createElement("div",{ref:e},d.createElement(it,{event:"focusin",handler:o}),d.createElement(ce,{keyCode:de.Tab,keyEvent:"keydown",handler:l}),a))}function Tt({instant:t,labelledBy:a,children:s,limitHeight:e,size:n,onClose:r,onExited:o,onEntered:l,setClosing:c,hasToasts:u,...h}){const g=lt(),x=p.useRef(null),M=p.useContext(xt);let y;M&&(y=M.toastMessages);const V=F(E.Modal,n&&E[Ye("size",n)],e&&E.limitHeight),S=t?k:Lt;p.useEffect(()=>{x.current&&!x.current.contains(document.activeElement)&&te(x.current)},[]);const P=()=>{c&&c(!0)},A=()=>{c&&c(!1),r()},w=d.createElement("div",{"aria-live":"assertive"},y?y.map(D=>d.createElement(Fe,{visuallyHidden:!0,as:"p",key:D.id},D.content)):null);return d.createElement(S,Object.assign({},h,{nodeRef:x,mountOnEnter:!0,unmountOnExit:!0,timeout:parseInt(g.motion["motion-duration-200"],10),onEntered:l,onExited:o}),d.createElement("div",{className:E.Container,"data-polaris-layer":!0,"data-polaris-overlay":!0,ref:x},d.createElement(Dt,null,d.createElement("div",{role:"dialog","aria-modal":!0,"aria-label":a,"aria-labelledby":a,tabIndex:-1,className:E.Dialog},d.createElement("div",{className:V},d.createElement(ce,{keyCode:de.Escape,keyEvent:"keydown",handler:P}),d.createElement(ce,{keyCode:de.Escape,handler:A}),s),w))))}const Ot={appear:F(E.animateFadeUp,E.entering),appearActive:F(E.animateFadeUp,E.entered),enter:F(E.animateFadeUp,E.entering),enterActive:F(E.animateFadeUp,E.entered),exit:F(E.animateFadeUp,E.exiting),exitActive:F(E.animateFadeUp,E.exited)};function Lt({children:t,...a}){return d.createElement(ge,Object.assign({},a,{classNames:Ot}),t)}function ye({pressed:t,onClick:a}){const s=we();return d.createElement(Y,{variant:"tertiary",pressed:t,icon:nt,onClick:a,accessibilityLabel:s.translate("Polaris.Common.close")})}function At({id:t,children:a,closing:s,titleHidden:e,onClose:n}){return e||!a?d.createElement(L,{position:"absolute",insetInlineEnd:"400",insetBlockStart:"400",zIndex:"1"},d.createElement(ye,{onClick:n})):d.createElement(L,{paddingBlockStart:"400",paddingBlockEnd:"400",paddingInlineStart:"400",paddingInlineEnd:"400",borderBlockEndWidth:"025",borderColor:"border",background:"bg-surface-tertiary"},d.createElement(mt,{columns:{xs:"1fr auto"},gap:"400"},d.createElement(j,{gap:"400",blockAlign:"center"},d.createElement(Fe,{id:t,as:"h2",variant:"headingMd",breakWord:!0},a)),d.createElement(ye,{pressed:s,onClick:n})))}function It({primaryAction:t,secondaryActions:a,children:s}){const e=t&&ve(t,{variant:"primary"})||null,n=a&&ve(a)||null,r=e||n?d.createElement(j,{gap:"200"},n,e):null;return d.createElement(j,{gap:"400",blockAlign:"center"},d.createElement(L,{borderColor:"border",borderBlockStartWidth:"025",padding:"400",width:"100%"},d.createElement(j,{gap:"400",blockAlign:"center",align:"space-between"},d.createElement(L,null,s),r)))}const ke=200,Rt=400,fe=function({children:a,title:s,titleHidden:e=!1,src:n,iFrameName:r,open:o,instant:l,sectioned:c,loading:u,size:h,limitHeight:g,footer:x,primaryAction:M,secondaryActions:y,onScrolledToBottom:V,activator:S,activatorWrapper:P="div",onClose:A,onIFrameLoad:w,onTransitionEnd:D,noScroll:ne}){const[ae,z]=p.useState(ke),[J,W]=p.useState(!1),f=p.useId(),m=p.useRef(null),C=we().translate("Polaris.Modal.iFrameTitle");let N,b;const Ae=p.useCallback(()=>{D&&D()},[D]),Ie=p.useCallback(()=>{z(ke);const I=S&&Me(S)?S&&S.current:m.current;I&&requestAnimationFrame(()=>te(I))},[S]),Re=p.useCallback(I=>{const K=I.target;if(K&&K.contentWindow)try{z(K.contentWindow.document.body.scrollHeight)}catch{z(Rt)}w!=null&&w(I)},[w]);if(o){const I=!x&&!M&&!y?null:d.createElement(It,{primaryAction:M,secondaryActions:y},x),K=c?Qe(a,Le,{titleHidden:e}):a,se=u?d.createElement(L,{padding:"400"},d.createElement(j,{gap:"400",align:"center",blockAlign:"center"},d.createElement(De,null))):K,$e=ne?d.createElement("div",{className:le.NoScrollBody},d.createElement(L,{width:"100%",overflowX:"hidden",overflowY:"hidden"},se)):d.createElement(tt,{shadow:!0,className:le.Body,onScrolledToBottom:V},se),Be=n?d.createElement("iframe",{name:r,title:C,src:n,className:le.IFrame,onLoad:Re,style:{height:`${ae}px`}}):$e;N=d.createElement(Tt,{instant:l,labelledBy:f,onClose:A,onEntered:Ae,onExited:Ie,size:h,limitHeight:g,setClosing:W},d.createElement(At,{titleHidden:e,id:f,closing:J,onClose:A},s),Be,I),b=d.createElement(ft,{setClosing:W,onClick:A})}const re=!l,_e=S&&!Me(S)?d.createElement(L,{ref:m,as:P},S):null;return d.createElement(Ze.Provider,{value:!0},_e,d.createElement(et,{idPrefix:"modal"},d.createElement(Ee,{appear:re,enter:re,exit:re},N),b))};function Me(t){return Object.prototype.hasOwnProperty.call(t,"current")}fe.Section=Le;function _t(t,a,s="all"){let e=t;return s==="k18"&&(e=t.filter(n=>n.title.includes("K18")||n.title.includes("18金"))),a&&(e=e.filter(n=>n.title.toLowerCase().includes(a.toLowerCase())||n.handle.toLowerCase().includes(a.toLowerCase()))),e}function $t(t,a,s=.93){const e=t*(1+a),n=t*s,r=Math.max(e,n);return Math.ceil(r/10)*10}function Bt({products:t,goldPrice:a,selectedProductIds:s,shopSetting:e}){var J,W;const n=Ge(),[r,o]=p.useState([]),[l,c]=p.useState(""),[u,h]=p.useState("all"),[g,x]=p.useState((e==null?void 0:e.minPricePct)||93),[M,y]=p.useState(!1),[V,S]=p.useState([]);p.useEffect(()=>{if(s&&s.length>0){const f=t.filter(m=>s.includes(m.id));o(f)}},[t,s]);const P=_t(t,l,u),A=p.useCallback((f,m)=>{const v=t.find(C=>C.id===f);o(m?C=>[...C,v]:C=>C.filter(N=>N.id!==f))},[t]),w=p.useCallback(f=>{o(f?P:[])},[P]),D=p.useCallback(()=>{const f=new FormData;f.append("action","saveSelection"),r.forEach(m=>{f.append("productId",m.id)}),n.submit(f,{method:"post"})},[r,n]),ne=p.useCallback(()=>{if(r.length===0||!a)return;const f=r.map(m=>({...m,variants:m.variants.edges.map(v=>{const C=v.node,N=parseFloat(C.price),b=$t(N,a.ratio,g/100);return{...C,currentPrice:N,newPrice:b,priceChange:b-N,changed:b!==N}})}));S(f),y(!0)},[r,a,g]),ae=p.useCallback(()=>{if(!a)return;const f=r.map(m=>({...m,variants:m.variants.edges.map(v=>v.node)}));n.submit({action:"updatePrices",selectedProducts:JSON.stringify(f),minPriceRate:g.toString()},{method:"post"}),y(!1)},[r,a,g,n]),z=P.map(f=>{var N;const m=r.some(b=>b.id===f.id),v=f.variants.edges,C=v.length>1?`¥${Math.min(...v.map(b=>parseFloat(b.node.price)))} - ¥${Math.max(...v.map(b=>parseFloat(b.node.price)))}`:`¥${((N=v[0])==null?void 0:N.node.price)||0}`;return[i.jsx(at,{checked:m,onChange:b=>A(f.id,b)}),f.title,i.jsx(Q,{status:f.status==="ACTIVE"?"success":"critical",children:f.status}),C,v.length]});return i.jsx(Te,{title:"商品価格自動調整",subtitle:`${P.length}件の商品（全${t.length}件）`,primaryAction:{content:"価格調整プレビュー",onAction:ne,disabled:r.length===0||!a,loading:n.state==="submitting"},children:i.jsxs(O,{children:[i.jsxs(O.Section,{children:[a&&i.jsx(T,{children:i.jsxs($,{gap:"400",children:[i.jsxs(j,{align:"space-between",children:[i.jsx("h3",{children:"田中貴金属 金価格情報"}),i.jsx(Q,{tone:a.changeDirection==="up"?"attention":a.changeDirection==="down"?"success":"info",children:a.changeDirection==="up"?"上昇":a.changeDirection==="down"?"下落":"変動なし"})]}),i.jsxs(j,{gap:"600",children:[i.jsxs("div",{children:[i.jsx("p",{children:"店頭小売価格（税込）"}),i.jsx("h4",{children:a.retailPriceFormatted})]}),i.jsxs("div",{children:[i.jsx("p",{children:"前日比"}),i.jsx("h4",{children:a.change})]})]}),i.jsx("div",{children:i.jsxs("p",{children:[i.jsxs("strong",{children:["価格調整率: ",a.percentage,"%"]}),"（この変動率で商品価格を自動調整します）"]})}),i.jsxs("p",{children:["最終更新: ",new Date(a.lastUpdated).toLocaleString("ja-JP")]})]})}),!a&&i.jsx(U,{tone:"critical",children:"金価格情報の取得に失敗しました。価格調整機能をご利用いただけません。"})]}),i.jsx(O.Section,{children:i.jsx(T,{children:i.jsxs($,{gap:"400",children:[i.jsx("h3",{children:"商品検索・選択"}),i.jsxs(j,{gap:"400",children:[i.jsx("div",{style:{flex:1},children:i.jsx(Ce,{label:"商品検索",value:l,onChange:c,placeholder:"商品名またはハンドルで検索...",clearButton:!0,onClearButtonClick:()=>c("")})}),i.jsx("div",{style:{minWidth:"150px"},children:i.jsx(rt,{label:"商品フィルター",options:[{label:"すべての商品",value:"all"},{label:"K18商品のみ",value:"k18"}],value:u,onChange:h})})]}),i.jsx(Ce,{label:"価格下限設定 (%)",type:"number",value:g.toString(),onChange:f=>x(parseInt(f)||93),suffix:"%",helpText:"現在価格に対する最低価格の割合（例: 93% = 7%以上は下がらない）",min:"50",max:"100"}),i.jsxs(j,{gap:"300",children:[i.jsx(Y,{onClick:()=>w(!0),disabled:P.length===0,size:"large",children:"すべて選択"}),i.jsx(Y,{onClick:()=>w(!1),disabled:r.length===0,size:"large",children:"選択解除"}),i.jsx(Y,{onClick:D,disabled:n.state==="submitting",variant:"primary",size:"large",children:"選択を保存"})]}),s&&s.length>0&&i.jsxs(U,{tone:"info",children:["現在 ",i.jsxs("strong",{children:[s.length,"件"]})," の商品が自動更新対象として保存されています"]}),((J=n.data)==null?void 0:J.message)&&i.jsx(U,{tone:"success",children:n.data.message})]})})}),i.jsx(O.Section,{children:i.jsx(T,{children:i.jsx(st,{columnContentTypes:["text","text","text","text","numeric"],headings:["選択","商品名","ステータス","価格","バリエーション"],rows:z,pagination:{hasNext:!1,hasPrevious:!1}})})}),i.jsx(fe,{open:M,onClose:()=>y(!1),title:"価格調整プレビュー",primaryAction:{content:"価格を更新",onAction:ae,loading:n.state==="submitting"},secondaryActions:[{content:"キャンセル",onAction:()=>y(!1)}],large:!0,children:i.jsx(fe.Section,{children:i.jsx($,{gap:"400",children:V.map(f=>i.jsx(T,{children:i.jsxs($,{gap:"300",children:[i.jsx("h4",{children:f.title}),f.variants.map(m=>i.jsxs(j,{align:"space-between",children:[i.jsx("span",{children:m.title||"デフォルト"}),i.jsxs(j,{gap:"200",children:[i.jsxs("span",{children:["¥",m.currentPrice," → ¥",m.newPrice]}),m.changed&&i.jsxs(Q,{tone:m.priceChange>0?"warning":"success",children:[m.priceChange>0?"+":"",m.priceChange,"円"]})]})]},m.id))]})},f.id))})})}),((W=n.data)==null?void 0:W.updateResults)&&i.jsx(O.Section,{children:i.jsx(T,{children:i.jsxs($,{gap:"400",children:[i.jsx("h3",{children:"価格更新結果"}),n.data.summary&&i.jsx(T,{children:i.jsxs(j,{gap:"400",children:[i.jsxs("div",{children:["合計: ",i.jsx("strong",{children:n.data.summary.total}),"件"]}),i.jsxs("div",{children:["成功: ",i.jsx("strong",{children:n.data.summary.success}),"件"]}),i.jsxs("div",{children:["失敗: ",i.jsx("strong",{children:n.data.summary.failed}),"件"]})]})}),n.data.error&&i.jsx(U,{tone:"critical",children:n.data.error}),n.data.message&&i.jsx(U,{tone:"info",children:n.data.message}),n.data.updateResults.map((f,m)=>{var v,C;return i.jsx(U,{tone:f.success?"success":"critical",children:f.success?`${f.product} - ${f.variant}: ¥${(v=f.oldPrice)==null?void 0:v.toLocaleString()} → ¥${(C=f.newPrice)==null?void 0:C.toLocaleString()}`:`${f.product} - ${f.variant}: ${f.error}`},m)})]})})})]})})}function Yt(){const t=Ue(),{goldPrice:a,selectedProductIds:s,shopSetting:e}=t;return i.jsx(p.Suspense,{fallback:i.jsx(Te,{title:"商品価格自動調整",subtitle:"読み込み中...",children:i.jsxs(O,{children:[i.jsx(O.Section,{children:a&&i.jsx(T,{children:i.jsxs($,{gap:"400",children:[i.jsxs(j,{align:"space-between",children:[i.jsx("h3",{children:"田中貴金属 金価格情報"}),i.jsx(Q,{tone:a.changeDirection==="up"?"attention":a.changeDirection==="down"?"success":"info",children:a.changeDirection==="up"?"上昇":a.changeDirection==="down"?"下落":"変動なし"})]}),i.jsxs(j,{gap:"600",children:[i.jsxs("div",{children:[i.jsx("p",{children:"店頭小売価格（税込）"}),i.jsx("h4",{children:a.retailPriceFormatted})]}),i.jsxs("div",{children:[i.jsx("p",{children:"前日比"}),i.jsx("h4",{children:a.change})]})]}),i.jsx("div",{children:i.jsxs("p",{children:[i.jsxs("strong",{children:["価格調整率: ",a.percentage,"%"]}),"（この変動率で商品価格を自動調整します）"]})}),i.jsxs("p",{children:["最終更新: ",new Date(a.lastUpdated).toLocaleString("ja-JP")]})]})})}),i.jsx(O.Section,{children:i.jsx(T,{children:i.jsx($,{gap:"400",children:i.jsxs("div",{style:{textAlign:"center",padding:"60px 20px"},children:[i.jsx(De,{size:"large"}),i.jsx("p",{style:{marginTop:"20px"},children:"商品データを読み込んでいます..."})]})})})})]})}),children:i.jsx(He,{resolve:t.products,children:n=>i.jsx(Bt,{products:n,goldPrice:a,selectedProductIds:s,shopSetting:e})})})}export{Yt as default};
