import{r as j,j as e}from"./index-OtPSfN_w.js";import{u as A}from"./components-CE-OXjA9.js";import{T as t,d as y,I as a,b as d,S as m,e as i,P as F,c as n,C as r,a as I}from"./Page-CUdf0xBo.js";import{S as v,a as f}from"./Select-DHDjkFid.js";import{L as S}from"./Layout-CN1seCzE.js";import{S as p}from"./ClockIcon.svg-Dq65wAvQ.js";import{D as L}from"./DataTable-dk25Vxus.js";import"./context-C9td0CMk.js";function z(){const{logs:c,stats:l}=A(),[x,b]=j.useState(""),[o,C]=j.useState("all"),[u,M]=j.useState("all"),h=c.filter(s=>{var g;const R=x===""||((g=s.errorMessage)==null?void 0:g.toLowerCase().includes(x.toLowerCase())),T=o==="all"||o==="success"&&s.success||o==="failed"&&!s.success,w=u==="all"||s.executionType===u;return R&&T&&w}),k=h.map(s=>[e.jsxs("div",{children:[e.jsx(t,{variant:"bodyMd",as:"p",children:new Date(s.executedAt).toLocaleDateString("ja-JP")}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:new Date(s.executedAt).toLocaleTimeString("ja-JP")})]},`time-${s.id}`),e.jsx(y,{tone:s.executionType==="auto"?"info":"warning",children:s.executionType==="auto"?"自動実行":"手動実行"},`type-${s.id}`),e.jsxs(a,{gap:"200",blockAlign:"center",children:[e.jsx(d,{source:s.success?v:m,tone:s.success?"success":"critical"}),e.jsx(y,{tone:s.success?"success":"critical",children:s.success?"成功":"失敗"})]},`status-${s.id}`),e.jsx("div",{children:s.goldRatio!==null&&s.goldRatio!==void 0?e.jsxs(a,{gap:"100",blockAlign:"center",children:[e.jsx("span",{style:{fontSize:"16px",color:s.goldRatio>=0?"#dc2626":"#059669"},children:s.goldRatio>=0?"📈":"📉"}),e.jsxs(t,{children:[(s.goldRatio*100).toFixed(2),"%"]})]}):e.jsx(t,{tone:"subdued",children:"-"})},`ratio-${s.id}`),e.jsxs(t,{children:[s.minPricePct||"-","%"]},`min-${s.id}`),e.jsxs(t,{children:[s.totalProducts||0,"件"]},`products-${s.id}`),e.jsxs(a,{gap:"200",children:[e.jsx(t,{tone:"success",children:s.updatedCount||0}),e.jsx(t,{tone:"subdued",children:"/"}),e.jsx(t,{tone:"critical",children:s.failedCount||0})]},`counts-${s.id}`),e.jsx("div",{children:s.errorMessage?e.jsx(i,{padding:"200",background:"bg-critical-subdued",borderRadius:"100",children:e.jsx(t,{variant:"bodySm",tone:"critical",children:s.errorMessage.length>50?s.errorMessage.substring(0,50)+"...":s.errorMessage})}):e.jsx(t,{tone:"subdued",children:"-"})},`error-${s.id}`)]);return e.jsx(F,{title:"実行ログ",subtitle:`${c.length}件の実行履歴を表示`,children:e.jsxs(n,{gap:"500",children:[e.jsx(S,{children:e.jsx(S.Section,{children:e.jsxs(a,{gap:"400",children:[e.jsx(r,{children:e.jsx(i,{padding:"400",style:{textAlign:"center"},children:e.jsxs(n,{gap:"300",align:"center",children:[e.jsx(i,{style:{width:"48px",height:"48px",background:"#e0f2fe",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(d,{source:p,tone:"info"})}),e.jsx(t,{variant:"heading2xl",as:"p",children:l.totalExecutions}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:"総実行回数"})]})})}),e.jsx(r,{children:e.jsx(i,{padding:"400",style:{textAlign:"center"},children:e.jsxs(n,{gap:"300",align:"center",children:[e.jsx(i,{style:{width:"48px",height:"48px",background:"#dcfce7",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(d,{source:v,tone:"success"})}),e.jsx(t,{variant:"heading2xl",as:"p",children:l.totalSuccess}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:"成功更新数"})]})})}),e.jsx(r,{children:e.jsx(i,{padding:"400",style:{textAlign:"center"},children:e.jsxs(n,{gap:"300",align:"center",children:[e.jsx(i,{style:{width:"48px",height:"48px",background:l.totalFailed>0?"#fecaca":"#f3f4f6",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(d,{source:m,tone:l.totalFailed>0?"critical":"subdued"})}),e.jsx(t,{variant:"heading2xl",as:"p",children:l.totalFailed}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:"失敗更新数"})]})})})]})})}),e.jsx(r,{children:e.jsxs(n,{gap:"400",children:[e.jsx(t,{variant:"headingMd",as:"h3",children:"フィルター"}),e.jsxs(a,{gap:"400",children:[e.jsx("div",{style:{minWidth:"200px"},children:e.jsx(I,{label:"エラーメッセージ検索",value:x,onChange:b,placeholder:"エラー内容で検索...",clearButton:!0,onClearButtonClick:()=>b("")})}),e.jsx("div",{style:{minWidth:"150px"},children:e.jsx(f,{label:"実行結果",options:[{label:"すべて",value:"all"},{label:"成功のみ",value:"success"},{label:"失敗のみ",value:"failed"}],value:o,onChange:C})}),e.jsx("div",{style:{minWidth:"150px"},children:e.jsx(f,{label:"実行タイプ",options:[{label:"すべて",value:"all"},{label:"自動実行",value:"auto"},{label:"手動実行",value:"manual"}],value:u,onChange:M})})]}),e.jsxs(t,{variant:"bodySm",tone:"subdued",children:[h.length,"件 / ",c.length,"件を表示"]})]})}),e.jsx(r,{children:h.length===0?e.jsx(i,{padding:"800",style:{textAlign:"center"},children:e.jsxs(n,{gap:"400",align:"center",children:[e.jsx(d,{source:p,tone:"subdued"}),e.jsx(t,{variant:"headingMd",tone:"subdued",children:c.length===0?"まだ実行ログがありません":"フィルター条件に一致するログがありません"}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:c.length===0?"商品価格調整を実行すると、ここに履歴が表示されます。":"フィルター条件を変更してください。"})]})}):e.jsx(L,{columnContentTypes:["text","text","text","text","text","text","text","text"],headings:["実行日時","種類","結果","金価格変動率","価格下限","対象商品","成功/失敗","エラー詳細"],rows:k,pagination:{hasNext:!1,hasPrevious:!1}})}),e.jsx(r,{children:e.jsx(i,{padding:"400",style:{background:"linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%)",borderRadius:"12px"},children:e.jsxs(n,{gap:"300",children:[e.jsxs(a,{gap:"200",blockAlign:"center",children:[e.jsx(d,{source:p,tone:"base"}),e.jsx(t,{variant:"headingMd",as:"h3",children:"ログの見方"})]}),e.jsxs(a,{gap:"600",children:[e.jsxs(n,{gap:"200",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"実行タイプ"}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:"• 自動実行: スケジュールによる定期実行"}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:"• 手動実行: UIからの手動実行"})]}),e.jsxs(n,{gap:"200",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"金価格変動率"}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:"• 田中貴金属から取得した前日比"}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:"• この変動率で商品価格を調整"})]}),e.jsxs(n,{gap:"200",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"価格下限"}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:"• 価格下落時の最低価格率"}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:"• 例: 93% = 7%以上は下がらない"})]})]})]})})})]})})}export{z as default};
