var ta=Object.defineProperty;var na=(t,n,s)=>n in t?ta(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s;var gn=(t,n,s)=>na(t,typeof n!="symbol"?n+"":n,s);import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{R as o,r as c,d as It}from"./index-Dfrec1kz.js";import{u as aa,A as ra,b as qt,w as la}from"./components-CVBppnN6.js";import{M as Nn,f as P,y as ia,k as et,c as Se,d as sa,z as oa,u as rn,A as Ln,D as Mn,T as W,j as Ge,x as ca,E as Yt,I as j,v as gt,F as da,w as Bn,p as ua,o as pa,s as ha,G as Ht,e as K,K as Zt,H as Qt,J as fa,N as ma,O as ga,Q as ba,R as bn,W as xa,V as va,X as Sa,Y as ln,n as Ea,a as Y,P as Hn,C as ve,B as fe,b as xn}from"./Page-BFDl36QU.js";import{L as Te}from"./Layout-TUPT4spf.js";import{C as tt,S as ya,B as je}from"./Banner-DWoduFFk.js";import{S as ft}from"./Select-CzcThcG5.js";import{E as Wn,p as Ta,l as ka,d as bt,m as Ca}from"./context-JUMp7zSJ.js";import{a as vn,S as Sn,b as Pa,A as ja}from"./Sticky-DoFvUJj_.js";import{S as wa,F as Aa}from"./context-BG6bh-td.js";import"./banner-context-BjQn27ta.js";var Nt=function(n){return o.createElement("svg",Object.assign({viewBox:"0 0 20 20"},n),o.createElement("path",{d:"M3.5 9.25a.75.75 0 0 0 1.5 0 3 3 0 0 1 3-3h6.566l-1.123 1.248a.75.75 0 1 0 1.114 1.004l2.25-2.5a.75.75 0 0 0-.027-1.032l-2.25-2.25a.75.75 0 1 0-1.06 1.06l.97.97h-6.44a4.5 4.5 0 0 0-4.5 4.5Z"}),o.createElement("path",{d:"M16.5 10.75a.75.75 0 0 0-1.5 0 3 3 0 0 1-3 3h-6.566l1.123-1.248a.75.75 0 1 0-1.114-1.004l-2.25 2.5a.75.75 0 0 0 .027 1.032l2.25 2.25a.75.75 0 0 0 1.06-1.06l-.97-.97h6.44a4.5 4.5 0 0 0 4.5-4.5Z"}))};Nt.displayName="RefreshIcon";const Rn=c.forwardRef(({alt:t,sourceSet:n,source:s,crossOrigin:a,onLoad:r,className:l,...p},u)=>{const d=n?n.map(({source:y,descriptor:x})=>`${y} ${x}`).join(","):null,m=c.useCallback(()=>{r&&r()},[r]);return o.createElement("img",Object.assign({ref:u,alt:t,src:s,crossOrigin:a,className:l,onLoad:m},d?{srcSet:d}:{},p))});Rn.displayName="Image";var Gt={Backdrop:"Polaris-Backdrop",transparent:"Polaris-Backdrop--transparent",belowNavigation:"Polaris-Backdrop--belowNavigation"};function Ia(){const t=c.useContext(wa);if(!t)throw new Nn("No ScrollLockManager was provided.");return t}function _a(t){const n=Ia();return c.useEffect(()=>(n.registerScrollLock(),()=>{n.unregisterScrollLock()}),[n]),null}function Na(t){const{onClick:n,onTouchStart:s,belowNavigation:a,transparent:r,setClosing:l}=t,p=P(Gt.Backdrop,a&&Gt.belowNavigation,r&&Gt.transparent),u=()=>{l&&l(!0)},d=()=>{l&&l(!1),n&&n()};return o.createElement(o.Fragment,null,o.createElement(_a,null),o.createElement("div",{className:p,onClick:d,onTouchStart:s,onMouseDown:u}))}function En(t=[],n,s,a){const r=s.reduce((d,m)=>d+m,0),l=t.map((d,m)=>m),p=[],u=[];if(a>r)p.push(...l);else{let d=0,m=!1;l.forEach(y=>{const x=s[y];if(d+x>=a-n||m){u.push(y),m=!0;return}p.push(y),d+=x})}return{visiblePromotedActions:p,hiddenPromotedActions:u}}function La(t){const n=t.filter(s=>s.items);return t.length===n.length}function Ma(t){const n=t.filter(s=>!s.items);return t.length===n.length}function en(t){return"title"in t&&"actions"in t}function Ba(t){return"items"in t}function Ha(t){if(!(!t||t.length===0)){if(La(t))return t;if(Ma(t))return[{items:t}]}}function yn(t){var n;if(!t)return!1;for(const s of t)for(const a of s.items)if(((n=a.badge)==null?void 0:n.tone)==="new")return!0;return!1}var De={BulkActionsOuterLayout:"Polaris-BulkActions__BulkActionsOuterLayout",BulkActionsSelectAllWrapper:"Polaris-BulkActions__BulkActionsSelectAllWrapper",BulkActionsPromotedActionsWrapper:"Polaris-BulkActions__BulkActionsPromotedActionsWrapper",BulkActionsLayout:"Polaris-BulkActions__BulkActionsLayout","BulkActionsLayout--measuring":"Polaris-BulkActions--bulkActionsLayoutMeasuring",BulkActionsMeasurerLayout:"Polaris-BulkActions__BulkActionsMeasurerLayout",BulkActionButton:"Polaris-BulkActions__BulkActionButton",AllAction:"Polaris-BulkActions__AllAction"},Tn={Indicator:"Polaris-Indicator",pulseIndicator:"Polaris-Indicator--pulseIndicator"};function Wa({pulse:t=!0}){const n=P(Tn.Indicator,t&&Tn.pulseIndicator);return o.createElement("span",{className:n})}function ot({handleMeasurement:t,url:n,external:s,onAction:a,content:r,disclosure:l,accessibilityLabel:p,disabled:u,destructive:d,indicator:m,showContentInButton:y,size:x}){const v=c.useRef(null);ia(()=>{if(t&&v.current){const E=v.current.getBoundingClientRect().width;t(E)}});const T=l&&!y,R=T?void 0:r,D=o.createElement(Se,{external:s,url:n,accessibilityLabel:T?r:p,tone:d?"critical":void 0,disclosure:l&&y,onClick:a,disabled:u,size:x,icon:T?o.createElement(sa,{source:oa,tone:"base"}):void 0},R);return o.createElement("div",{className:De.BulkActionButton,ref:v},T?o.createElement(et,{content:r,preferredPosition:"below"},D):D,m&&o.createElement(Wa,null))}function Ra({title:t,actions:n,isNewBadgeInBadgeActions:s,size:a}){const{value:r,toggle:l}=rn(!1);return o.createElement(o.Fragment,null,o.createElement(Ln,{active:r,activator:o.createElement(ot,{disclosure:!0,showContentInButton:!0,onAction:l,content:t,indicator:s,size:a}),onClose:l,preferInputActivator:!0},o.createElement(Mn,{items:n,onActionAnyItem:l})))}var Kt={CheckableButton:"Polaris-CheckableButton",Checkbox:"Polaris-CheckableButton__Checkbox",Label:"Polaris-CheckableButton__Label"};const Da=c.forwardRef(function({accessibilityLabel:n,label:s="",onToggleAll:a,selected:r,disabled:l,ariaLive:p},u){const d=c.useRef(null);function m(){var y;(y=d==null?void 0:d.current)==null||y.focus()}return c.useImperativeHandle(u,()=>({focus:m})),o.createElement("div",{className:Kt.CheckableButton,onClick:a},o.createElement("div",{className:Kt.Checkbox},o.createElement(tt,{label:n,labelHidden:!0,checked:r,disabled:l,onChange:a,ref:d})),s?o.createElement("span",{className:Kt.Label,"aria-live":p},o.createElement(W,{as:"span",variant:"bodySm",fontWeight:"medium"},s)):null)}),Fa=4;function Oa({promotedActions:t=[],disabled:n,buttonSize:s,handleMeasurement:a}){const r=Ge(),l=c.useRef(null),p=r.translate("Polaris.ResourceList.BulkActions.moreActionsActivatorLabel"),u=o.createElement(ot,{disclosure:!0,content:p}),d=c.useCallback(()=>{if(!l.current)return;const y=l.current.offsetWidth,x=l.current.children,T=Array.from(x).map(D=>Math.ceil(D.getBoundingClientRect().width)+Fa),R=T.pop()||0;a({containerWidth:y,disclosureWidth:R,hiddenActionsWidths:T})},[a]);c.useEffect(()=>{d()},[d,t]);const m=t.map((y,x)=>en(y)?o.createElement(ot,{key:x,disclosure:!0,showContentInButton:!0,content:y.title,size:s}):o.createElement(ot,Object.assign({key:x,disabled:n},y,{size:s})));return ca("resize",d),o.createElement("div",{className:De.BulkActionsMeasurerLayout,ref:l},m,u)}const $a=c.forwardRef(function({promotedActions:n,actions:s,disabled:a,buttonSize:r,paginatedSelectAllAction:l,paginatedSelectAllText:p,label:u,accessibilityLabel:d,selected:m,onToggleAll:y,onMoreActionPopoverToggle:x,width:v,selectMode:T},R){const D=Ge(),[E,L]=c.useState(!1),[k,F]=c.useReducer((_,A)=>({..._,...A}),{disclosureWidth:0,containerWidth:1/0,actionsWidths:[],visiblePromotedActions:[],hiddenPromotedActions:[],hasMeasured:!1}),{visiblePromotedActions:le,hiddenPromotedActions:Z,containerWidth:$,disclosureWidth:Q,actionsWidths:M,hasMeasured:ke}=k;c.useEffect(()=>{if($===0||!n||n.length===0)return;const{visiblePromotedActions:_,hiddenPromotedActions:A}=En(n,Q,M,$);F({visiblePromotedActions:_,hiddenPromotedActions:A,hasMeasured:$!==1/0})},[$,Q,n,M]);const z=!n||n&&le.length===0?D.translate("Polaris.ResourceList.BulkActions.actionsActivatorLabel"):D.translate("Polaris.ResourceList.BulkActions.moreActionsActivatorLabel"),V=l?o.createElement(Yt,{className:De.AllAction,onClick:l.onAction,size:"slim",disabled:a},o.createElement(W,{as:"span",variant:"bodySm",fontWeight:"medium"},l.content)):null,J=p&&l,ue={accessibilityLabel:d,label:J?p:u,selected:m,onToggleAll:y,disabled:a,ariaLive:J?"polite":void 0,ref:R},I=c.useCallback(()=>{x==null||x(E),L(_=>!_)},[x,E]),ie=c.useCallback(_=>{const{hiddenActionsWidths:A,containerWidth:H,disclosureWidth:Ee}=_;if(!n||n.length===0)return;const{visiblePromotedActions:te,hiddenPromotedActions:Ne}=En(n,Ee,A,H);F({visiblePromotedActions:te,hiddenPromotedActions:Ne,actionsWidths:A,containerWidth:H,disclosureWidth:Ee,hasMeasured:!0})},[n]),G=Ha(s),X=n?n.filter((_,A)=>!!le.includes(A)).map((_,A)=>en(_)?o.createElement(Ra,Object.assign({key:A},_,{isNewBadgeInBadgeActions:yn(G),size:r})):o.createElement(ot,Object.assign({key:A,disabled:a},_,{size:r}))):null,pe={items:Z.map(_=>n==null?void 0:n[_]).reduce((_,A)=>A?en(A)?_.concat(A.actions):_.concat(A):_,[])},U=c.useMemo(()=>{if(G)return G;if(!s)return[];let _=!0;return s.filter(A=>A).reduce((A,H)=>{if(Ba(H))return _=!1,A.concat(H);if(_){if(A.length===0)return[{items:[H]}];const Ee=A[A.length-1];return A.splice(A.length-1,1,{items:[...Ee.items,H]}),A}return _=!0,A.concat({items:[H]})},[])},[s,G]),Ce=o.createElement(ot,{disclosure:!0,showContentInButton:!X,onAction:I,content:z,disabled:a,indicator:yn(G),size:r}),Je=U.length>0?o.createElement(Ln,{active:E,activator:Ce,preferredAlignment:"right",onClose:I},o.createElement(Mn,{sections:pe.items.length>0?[pe,...U]:U,onActionAnyItem:I})):null,_e=o.createElement(Oa,{promotedActions:n,disabled:a,buttonSize:r,handleMeasurement:ie});return o.createElement("div",{className:De.BulkActions,style:v?{width:v}:void 0},o.createElement(j,{gap:"400",blockAlign:"center"},o.createElement("div",{className:De.BulkActionsSelectAllWrapper},o.createElement(Da,ue),V),T?o.createElement("div",{className:De.BulkActionsPromotedActionsWrapper},o.createElement(j,{gap:"100",blockAlign:"center"},o.createElement("div",{className:De.BulkActionsOuterLayout},_e,o.createElement("div",{className:P(De.BulkActionsLayout,!ke&&De["BulkActionsLayout--measuring"])},X)),Je)):null))});var Ue={LegacyStack:"Polaris-LegacyStack",Item:"Polaris-LegacyStack__Item",noWrap:"Polaris-LegacyStack--noWrap",spacingNone:"Polaris-LegacyStack--spacingNone",spacingExtraTight:"Polaris-LegacyStack--spacingExtraTight",spacingTight:"Polaris-LegacyStack--spacingTight",spacingBaseTight:"Polaris-LegacyStack--spacingBaseTight",spacingLoose:"Polaris-LegacyStack--spacingLoose",spacingExtraLoose:"Polaris-LegacyStack--spacingExtraLoose",distributionLeading:"Polaris-LegacyStack--distributionLeading",distributionTrailing:"Polaris-LegacyStack--distributionTrailing",distributionCenter:"Polaris-LegacyStack--distributionCenter",distributionEqualSpacing:"Polaris-LegacyStack--distributionEqualSpacing",distributionFill:"Polaris-LegacyStack--distributionFill",distributionFillEvenly:"Polaris-LegacyStack--distributionFillEvenly",alignmentLeading:"Polaris-LegacyStack--alignmentLeading",alignmentTrailing:"Polaris-LegacyStack--alignmentTrailing",alignmentCenter:"Polaris-LegacyStack--alignmentCenter",alignmentFill:"Polaris-LegacyStack--alignmentFill",alignmentBaseline:"Polaris-LegacyStack--alignmentBaseline",vertical:"Polaris-LegacyStack--vertical","Item-fill":"Polaris-LegacyStack__Item--fill"};function Dn({children:t,fill:n}){const s=P(Ue.Item,n&&Ue["Item-fill"]);return o.createElement("div",{className:s},t)}const sn=c.memo(function({children:n,vertical:s,spacing:a,distribution:r,alignment:l,wrap:p}){const u=P(Ue.LegacyStack,s&&Ue.vertical,a&&Ue[gt("spacing",a)],r&&Ue[gt("distribution",r)],l&&Ue[gt("alignment",l)],p===!1&&Ue.noWrap),d=da(n).map((m,y)=>Bn(m,Dn,{key:y}));return o.createElement("div",{className:u},d)});sn.Item=Dn;var za={InlineGrid:"Polaris-InlineGrid"};function Ua({children:t,columns:n,gap:s,alignItems:a}){const r={...pa("inline-grid","grid-template-columns",Va(n)),...ua("inline-grid","gap","space",s),"--pc-inline-grid-align-items":a};return o.createElement("div",{className:za.InlineGrid,style:ha(r)},t)}function Va(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.fromEntries(Object.entries(t).map(([n,s])=>[n,kn(s)])):kn(t)}function kn(t){if(t)return typeof t=="number"||!isNaN(Number(t))?`repeat(${Number(t)}, minmax(0, 1fr))`:typeof t=="string"?t:t.map(n=>{switch(n){case"oneThird":return"minmax(0, 1fr)";case"oneHalf":return"minmax(0, 1fr)";case"twoThirds":return"minmax(0, 2fr)"}}).join(" ")}const Ga=c.createContext(void 0);var Ka="data:image/svg+xml,%3csvg width='60' height='60' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill-rule='evenodd' d='M41.87 24a17.87 17.87 0 11-35.74 0 17.87 17.87 0 0135.74 0zm-3.15 18.96a24 24 0 114.24-4.24L59.04 54.8a3 3 0 11-4.24 4.24L38.72 42.96z' fill='%238C9196'/%3e%3c/svg%3e",Ja=Ka;function Xa({title:t,description:n,withIllustration:s}){const r=Ge().translate("Polaris.EmptySearchResult.altText"),l=n?o.createElement("p",null,n):null,p=s?o.createElement(Rn,{alt:r,source:Ja,draggable:!1}):null;return o.createElement(sn,{alignment:"center",vertical:!0},p,o.createElement(W,{variant:"headingLg",as:"p"},t),o.createElement(W,{tone:"subdued",as:"span"},l))}const qa=c.memo(function({children:n,disabled:s,root:a}){return c.useEffect(()=>{if(s||!a)return;const r=Ya(a)?a.current:a;!r||r.querySelector("[autofocus]")||Ht(r,!1)},[s,a]),o.createElement(o.Fragment,null,n)});function Ya(t){return t.current!==void 0}function Lt(){return Lt=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var a in s)({}).hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},Lt.apply(null,arguments)}function on(t,n){if(t==null)return{};var s={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(n.indexOf(a)!==-1)continue;s[a]=t[a]}return s}function tn(t,n){return tn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},tn(t,n)}function cn(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,tn(t,n)}function Za(t,n){return t.classList?!!n&&t.classList.contains(n):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+n+" ")!==-1}function Qa(t,n){t.classList?t.classList.add(n):Za(t,n)||(typeof t.className=="string"?t.className=t.className+" "+n:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+n))}function Cn(t,n){return t.replace(new RegExp("(^|\\s)"+n+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function er(t,n){t.classList?t.classList.remove(n):typeof t.className=="string"?t.className=Cn(t.className,n):t.setAttribute("class",Cn(t.className&&t.className.baseVal||"",n))}const Pn={disabled:!1},Mt=o.createContext(null);var Fn=function(n){return n.scrollTop},mt="unmounted",Ze="exited",Qe="entering",st="entered",nn="exiting",Ie=(function(t){cn(n,t);function n(a,r){var l;l=t.call(this,a,r)||this;var p=r,u=p&&!p.isMounting?a.enter:a.appear,d;return l.appearStatus=null,a.in?u?(d=Ze,l.appearStatus=Qe):d=st:a.unmountOnExit||a.mountOnEnter?d=mt:d=Ze,l.state={status:d},l.nextCallback=null,l}n.getDerivedStateFromProps=function(r,l){var p=r.in;return p&&l.status===mt?{status:Ze}:null};var s=n.prototype;return s.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},s.componentDidUpdate=function(r){var l=null;if(r!==this.props){var p=this.state.status;this.props.in?p!==Qe&&p!==st&&(l=Qe):(p===Qe||p===st)&&(l=nn)}this.updateStatus(!1,l)},s.componentWillUnmount=function(){this.cancelNextCallback()},s.getTimeouts=function(){var r=this.props.timeout,l,p,u;return l=p=u=r,r!=null&&typeof r!="number"&&(l=r.exit,p=r.enter,u=r.appear!==void 0?r.appear:p),{exit:l,enter:p,appear:u}},s.updateStatus=function(r,l){if(r===void 0&&(r=!1),l!==null)if(this.cancelNextCallback(),l===Qe){if(this.props.unmountOnExit||this.props.mountOnEnter){var p=this.props.nodeRef?this.props.nodeRef.current:It.findDOMNode(this);p&&Fn(p)}this.performEnter(r)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Ze&&this.setState({status:mt})},s.performEnter=function(r){var l=this,p=this.props.enter,u=this.context?this.context.isMounting:r,d=this.props.nodeRef?[u]:[It.findDOMNode(this),u],m=d[0],y=d[1],x=this.getTimeouts(),v=u?x.appear:x.enter;if(!r&&!p||Pn.disabled){this.safeSetState({status:st},function(){l.props.onEntered(m)});return}this.props.onEnter(m,y),this.safeSetState({status:Qe},function(){l.props.onEntering(m,y),l.onTransitionEnd(v,function(){l.safeSetState({status:st},function(){l.props.onEntered(m,y)})})})},s.performExit=function(){var r=this,l=this.props.exit,p=this.getTimeouts(),u=this.props.nodeRef?void 0:It.findDOMNode(this);if(!l||Pn.disabled){this.safeSetState({status:Ze},function(){r.props.onExited(u)});return}this.props.onExit(u),this.safeSetState({status:nn},function(){r.props.onExiting(u),r.onTransitionEnd(p.exit,function(){r.safeSetState({status:Ze},function(){r.props.onExited(u)})})})},s.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},s.safeSetState=function(r,l){l=this.setNextCallback(l),this.setState(r,l)},s.setNextCallback=function(r){var l=this,p=!0;return this.nextCallback=function(u){p&&(p=!1,l.nextCallback=null,r(u))},this.nextCallback.cancel=function(){p=!1},this.nextCallback},s.onTransitionEnd=function(r,l){this.setNextCallback(l);var p=this.props.nodeRef?this.props.nodeRef.current:It.findDOMNode(this),u=r==null&&!this.props.addEndListener;if(!p||u){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var d=this.props.nodeRef?[this.nextCallback]:[p,this.nextCallback],m=d[0],y=d[1];this.props.addEndListener(m,y)}r!=null&&setTimeout(this.nextCallback,r)},s.render=function(){var r=this.state.status;if(r===mt)return null;var l=this.props,p=l.children;l.in,l.mountOnEnter,l.unmountOnExit,l.appear,l.enter,l.exit,l.timeout,l.addEndListener,l.onEnter,l.onEntering,l.onEntered,l.onExit,l.onExiting,l.onExited,l.nodeRef;var u=on(l,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return o.createElement(Mt.Provider,{value:null},typeof p=="function"?p(r,u):o.cloneElement(o.Children.only(p),u))},n})(o.Component);Ie.contextType=Mt;Ie.propTypes={};function it(){}Ie.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:it,onEntering:it,onEntered:it,onExit:it,onExiting:it,onExited:it};Ie.UNMOUNTED=mt;Ie.EXITED=Ze;Ie.ENTERING=Qe;Ie.ENTERED=st;Ie.EXITING=nn;var tr=function(n,s){return n&&s&&s.split(" ").forEach(function(a){return Qa(n,a)})},Jt=function(n,s){return n&&s&&s.split(" ").forEach(function(a){return er(n,a)})},dn=(function(t){cn(n,t);function n(){for(var a,r=arguments.length,l=new Array(r),p=0;p<r;p++)l[p]=arguments[p];return a=t.call.apply(t,[this].concat(l))||this,a.appliedClasses={appear:{},enter:{},exit:{}},a.onEnter=function(u,d){var m=a.resolveArguments(u,d),y=m[0],x=m[1];a.removeClasses(y,"exit"),a.addClass(y,x?"appear":"enter","base"),a.props.onEnter&&a.props.onEnter(u,d)},a.onEntering=function(u,d){var m=a.resolveArguments(u,d),y=m[0],x=m[1],v=x?"appear":"enter";a.addClass(y,v,"active"),a.props.onEntering&&a.props.onEntering(u,d)},a.onEntered=function(u,d){var m=a.resolveArguments(u,d),y=m[0],x=m[1],v=x?"appear":"enter";a.removeClasses(y,v),a.addClass(y,v,"done"),a.props.onEntered&&a.props.onEntered(u,d)},a.onExit=function(u){var d=a.resolveArguments(u),m=d[0];a.removeClasses(m,"appear"),a.removeClasses(m,"enter"),a.addClass(m,"exit","base"),a.props.onExit&&a.props.onExit(u)},a.onExiting=function(u){var d=a.resolveArguments(u),m=d[0];a.addClass(m,"exit","active"),a.props.onExiting&&a.props.onExiting(u)},a.onExited=function(u){var d=a.resolveArguments(u),m=d[0];a.removeClasses(m,"exit"),a.addClass(m,"exit","done"),a.props.onExited&&a.props.onExited(u)},a.resolveArguments=function(u,d){return a.props.nodeRef?[a.props.nodeRef.current,u]:[u,d]},a.getClassNames=function(u){var d=a.props.classNames,m=typeof d=="string",y=m&&d?d+"-":"",x=m?""+y+u:d[u],v=m?x+"-active":d[u+"Active"],T=m?x+"-done":d[u+"Done"];return{baseClassName:x,activeClassName:v,doneClassName:T}},a}var s=n.prototype;return s.addClass=function(r,l,p){var u=this.getClassNames(l)[p+"ClassName"],d=this.getClassNames("enter"),m=d.doneClassName;l==="appear"&&p==="done"&&m&&(u+=" "+m),p==="active"&&r&&Fn(r),u&&(this.appliedClasses[l][p]=u,tr(r,u))},s.removeClasses=function(r,l){var p=this.appliedClasses[l],u=p.base,d=p.active,m=p.done;this.appliedClasses[l]={},u&&Jt(r,u),d&&Jt(r,d),m&&Jt(r,m)},s.render=function(){var r=this.props;r.classNames;var l=on(r,["classNames"]);return o.createElement(Ie,Lt({},l,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},n})(o.Component);dn.defaultProps={classNames:""};dn.propTypes={};function nr(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function un(t,n){var s=function(l){return n&&c.isValidElement(l)?n(l):l},a=Object.create(null);return t&&c.Children.map(t,function(r){return r}).forEach(function(r){a[r.key]=s(r)}),a}function ar(t,n){t=t||{},n=n||{};function s(y){return y in n?n[y]:t[y]}var a=Object.create(null),r=[];for(var l in t)l in n?r.length&&(a[l]=r,r=[]):r.push(l);var p,u={};for(var d in n){if(a[d])for(p=0;p<a[d].length;p++){var m=a[d][p];u[a[d][p]]=s(m)}u[d]=s(d)}for(p=0;p<r.length;p++)u[r[p]]=s(r[p]);return u}function nt(t,n,s){return s[n]!=null?s[n]:t.props[n]}function rr(t,n){return un(t.children,function(s){return c.cloneElement(s,{onExited:n.bind(null,s),in:!0,appear:nt(s,"appear",t),enter:nt(s,"enter",t),exit:nt(s,"exit",t)})})}function lr(t,n,s){var a=un(t.children),r=ar(n,a);return Object.keys(r).forEach(function(l){var p=r[l];if(c.isValidElement(p)){var u=l in n,d=l in a,m=n[l],y=c.isValidElement(m)&&!m.props.in;d&&(!u||y)?r[l]=c.cloneElement(p,{onExited:s.bind(null,p),in:!0,exit:nt(p,"exit",t),enter:nt(p,"enter",t)}):!d&&u&&!y?r[l]=c.cloneElement(p,{in:!1}):d&&u&&c.isValidElement(m)&&(r[l]=c.cloneElement(p,{onExited:s.bind(null,p),in:m.props.in,exit:nt(p,"exit",t),enter:nt(p,"enter",t)}))}}),r}var ir=Object.values||function(t){return Object.keys(t).map(function(n){return t[n]})},sr={component:"div",childFactory:function(n){return n}},pn=(function(t){cn(n,t);function n(a,r){var l;l=t.call(this,a,r)||this;var p=l.handleExited.bind(nr(l));return l.state={contextValue:{isMounting:!0},handleExited:p,firstRender:!0},l}var s=n.prototype;return s.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},s.componentWillUnmount=function(){this.mounted=!1},n.getDerivedStateFromProps=function(r,l){var p=l.children,u=l.handleExited,d=l.firstRender;return{children:d?rr(r,u):lr(r,p,u),firstRender:!1}},s.handleExited=function(r,l){var p=un(this.props.children);r.key in p||(r.props.onExited&&r.props.onExited(l),this.mounted&&this.setState(function(u){var d=Lt({},u.children);return delete d[r.key],{children:d}}))},s.render=function(){var r=this.props,l=r.component,p=r.childFactory,u=on(r,["component","childFactory"]),d=this.state.contextValue,m=ir(this.state.children).map(p);return delete u.appear,delete u.enter,delete u.exit,l===null?o.createElement(Mt.Provider,{value:d},m):o.createElement(Mt.Provider,{value:d},o.createElement(l,u,m))},n})(o.Component);pn.propTypes={};pn.defaultProps=sr;function or(t,n,s){if(!document)return;document.documentElement.style.setProperty(t,n)}var Xt={Body:"Polaris-Modal__Body",NoScrollBody:"Polaris-Modal__NoScrollBody",IFrame:"Polaris-Modal__IFrame"},jn={Section:"Polaris-Modal-Section",titleHidden:"Polaris-Modal-Section--titleHidden"};function On({children:t,flush:n=!1,subdued:s=!1,titleHidden:a=!1}){const r=P(jn.Section,a&&jn.titleHidden);return o.createElement("div",{className:r},o.createElement(K,Object.assign({as:"section",padding:n?"0":"400"},a&&{paddingInlineEnd:"0"},s&&{background:"bg-surface-tertiary"}),t))}var ae={Container:"Polaris-Modal-Dialog__Container",Dialog:"Polaris-Modal-Dialog",Modal:"Polaris-Modal-Dialog__Modal",limitHeight:"Polaris-Modal-Dialog--limitHeight",sizeSmall:"Polaris-Modal-Dialog--sizeSmall",sizeLarge:"Polaris-Modal-Dialog--sizeLarge",sizeFullScreen:"Polaris-Modal-Dialog--sizeFullScreen",animateFadeUp:"Polaris-Modal-Dialog--animateFadeUp",entering:"Polaris-Modal-Dialog--entering",exiting:"Polaris-Modal-Dialog--exiting",exited:"Polaris-Modal-Dialog--exited",entered:"Polaris-Modal-Dialog--entered"};function cr({trapping:t}){const n=c.useContext(Aa),s=c.useId();if(!n)throw new Nn("No FocusManager was provided.");const{trapFocusList:a,add:r,remove:l}=n,p=a[0]===s,u=c.useMemo(()=>({canSafelyFocus:p}),[p]);return c.useEffect(()=>{if(t)return r(s),()=>{l(s)}},[r,s,l,t]),u}function dr({trapping:t=!0,children:n}){const{canSafelyFocus:s}=cr({trapping:t}),a=c.useRef(null),[r,l]=c.useState(!0);c.useEffect(()=>{const d=s&&!(a.current&&a.current.contains(document.activeElement))?!t:!0;l(d)},[s,t]);const p=d=>{const m=a.current&&a.current.contains(document.activeElement);t===!1||!a.current||m||d.target instanceof Element&&d.target.matches(`${Ta.selector} *`)||s&&d.target instanceof HTMLElement&&a.current!==d.target&&!a.current.contains(d.target)&&Ht(a.current)},u=d=>{if(t===!1||!a.current)return;const m=fa(a.current),y=ma(a.current);d.target===y&&!d.shiftKey&&(d.preventDefault(),ga(a.current)),d.target===m&&d.shiftKey&&(d.preventDefault(),ba(a.current))};return o.createElement(qa,{disabled:r,root:a.current},o.createElement("div",{ref:a},o.createElement(Wn,{event:"focusin",handler:p}),o.createElement(Zt,{keyCode:Qt.Tab,keyEvent:"keydown",handler:u}),n))}function ur({instant:t,labelledBy:n,children:s,limitHeight:a,size:r,onClose:l,onExited:p,onEntered:u,setClosing:d,hasToasts:m,...y}){const x=ka(),v=c.useRef(null),T=c.useContext(Ga);let R;T&&(R=T.toastMessages);const D=P(ae.Modal,r&&ae[gt("size",r)],a&&ae.limitHeight),E=t?Ie:hr;c.useEffect(()=>{v.current&&!v.current.contains(document.activeElement)&&Ht(v.current)},[]);const L=()=>{d&&d(!0)},k=()=>{d&&d(!1),l()},F=o.createElement("div",{"aria-live":"assertive"},R?R.map(le=>o.createElement(W,{visuallyHidden:!0,as:"p",key:le.id},le.content)):null);return o.createElement(E,Object.assign({},y,{nodeRef:v,mountOnEnter:!0,unmountOnExit:!0,timeout:parseInt(x.motion["motion-duration-200"],10),onEntered:u,onExited:p}),o.createElement("div",{className:ae.Container,"data-polaris-layer":!0,"data-polaris-overlay":!0,ref:v},o.createElement(dr,null,o.createElement("div",{role:"dialog","aria-modal":!0,"aria-label":n,"aria-labelledby":n,tabIndex:-1,className:ae.Dialog},o.createElement("div",{className:D},o.createElement(Zt,{keyCode:Qt.Escape,keyEvent:"keydown",handler:L}),o.createElement(Zt,{keyCode:Qt.Escape,handler:k}),s),F))))}const pr={appear:P(ae.animateFadeUp,ae.entering),appearActive:P(ae.animateFadeUp,ae.entered),enter:P(ae.animateFadeUp,ae.entering),enterActive:P(ae.animateFadeUp,ae.entered),exit:P(ae.animateFadeUp,ae.exiting),exitActive:P(ae.animateFadeUp,ae.exited)};function hr({children:t,...n}){return o.createElement(dn,Object.assign({},n,{classNames:pr}),t)}function wn({pressed:t,onClick:n}){const s=Ge();return o.createElement(Se,{variant:"tertiary",pressed:t,icon:ya,onClick:n,accessibilityLabel:s.translate("Polaris.Common.close")})}function fr({id:t,children:n,closing:s,titleHidden:a,onClose:r}){return a||!n?o.createElement(K,{position:"absolute",insetInlineEnd:"400",insetBlockStart:"400",zIndex:"1"},o.createElement(wn,{onClick:r})):o.createElement(K,{paddingBlockStart:"400",paddingBlockEnd:"400",paddingInlineStart:"400",paddingInlineEnd:"400",borderBlockEndWidth:"025",borderColor:"border",background:"bg-surface-tertiary"},o.createElement(Ua,{columns:{xs:"1fr auto"},gap:"400"},o.createElement(j,{gap:"400",blockAlign:"center"},o.createElement(W,{id:t,as:"h2",variant:"headingMd",breakWord:!0},n)),o.createElement(wn,{pressed:s,onClick:r})))}function mr({primaryAction:t,secondaryActions:n,children:s}){const a=t&&bn(t,{variant:"primary"})||null,r=n&&bn(n)||null,l=a||r?o.createElement(j,{gap:"200"},r,a):null;return o.createElement(j,{gap:"400",blockAlign:"center"},o.createElement(K,{borderColor:"border",borderBlockStartWidth:"025",padding:"400",width:"100%"},o.createElement(j,{gap:"400",blockAlign:"center",align:"space-between"},o.createElement(K,null,s),l)))}const An=200,gr=400,an=function({children:n,title:s,titleHidden:a=!1,src:r,iFrameName:l,open:p,instant:u,sectioned:d,loading:m,size:y,limitHeight:x,footer:v,primaryAction:T,secondaryActions:R,onScrolledToBottom:D,activator:E,activatorWrapper:L="div",onClose:k,onIFrameLoad:F,onTransitionEnd:le,noScroll:Z}){const[$,Q]=c.useState(An),[M,ke]=c.useState(!1),z=c.useId(),V=c.useRef(null),de=Ge().translate("Polaris.Modal.iFrameTitle");let ue,I;const ie=c.useCallback(()=>{le&&le()},[le]),G=c.useCallback(()=>{Q(An);const pe=E&&In(E)?E&&E.current:V.current;pe&&requestAnimationFrame(()=>Ht(pe))},[E]),X=c.useCallback(pe=>{const U=pe.target;if(U&&U.contentWindow)try{Q(U.contentWindow.document.body.scrollHeight)}catch{Q(gr)}F!=null&&F(pe)},[F]);if(p){const pe=!v&&!T&&!R?null:o.createElement(mr,{primaryAction:T,secondaryActions:R},v),U=d?Bn(n,On,{titleHidden:a}):n,Ce=m?o.createElement(K,{padding:"400"},o.createElement(j,{gap:"400",align:"center",blockAlign:"center"},o.createElement(ln,null))):U,Je=Z?o.createElement("div",{className:Xt.NoScrollBody},o.createElement(K,{width:"100%",overflowX:"hidden",overflowY:"hidden"},Ce)):o.createElement(Sa,{shadow:!0,className:Xt.Body,onScrolledToBottom:D},Ce),_e=r?o.createElement("iframe",{name:l,title:de,src:r,className:Xt.IFrame,onLoad:X,style:{height:`${$}px`}}):Je;ue=o.createElement(ur,{instant:u,labelledBy:z,onClose:k,onEntered:ie,onExited:G,size:y,limitHeight:x,setClosing:ke},o.createElement(fr,{titleHidden:a,id:z,closing:M,onClose:k},s),_e,pe),I=o.createElement(Na,{setClosing:ke,onClick:k})}const ee=!u,Ke=E&&!In(E)?o.createElement(K,{ref:V,as:L},E):null;return o.createElement(xa.Provider,{value:!0},Ke,o.createElement(va,{idPrefix:"modal"},o.createElement(pn,{appear:ee,enter:ee,exit:ee},ue),I))};function In(t){return Object.prototype.hasOwnProperty.call(t,"current")}an.Section=On;var b={IndexTable:"Polaris-IndexTable",IndexTableWrapper:"Polaris-IndexTable__IndexTableWrapper","IndexTableWrapper-scrollBarHidden":"Polaris-IndexTable__IndexTableWrapper--scrollBarHidden",IndexTableWrapperWithSelectAllActions:"Polaris-IndexTable__IndexTableWrapperWithSelectAllActions",LoadingPanel:"Polaris-IndexTable__LoadingPanel",LoadingPanelEntered:"Polaris-IndexTable__LoadingPanelEntered",LoadingPanelRow:"Polaris-IndexTable__LoadingPanelRow",LoadingPanelText:"Polaris-IndexTable__LoadingPanelText",Table:"Polaris-IndexTable__Table","Table-scrolling":"Polaris-IndexTable__Table--scrolling","TableCell-first":"Polaris-IndexTable__TableCell--first","StickyTable-scrolling":"Polaris-IndexTable__StickyTable--scrolling",TableCell:"Polaris-IndexTable__TableCell","TableHeading-first":"Polaris-IndexTable__TableHeading--first","TableHeading-second":"Polaris-IndexTable__TableHeading--second","Table-sticky":"Polaris-IndexTable__Table--sticky",StickyTable:"Polaris-IndexTable__StickyTable","Table-unselectable":"Polaris-IndexTable__Table--unselectable",TableRow:"Polaris-IndexTable__TableRow","TableRow-unclickable":"Polaris-IndexTable__TableRow--unclickable",toneSuccess:"Polaris-IndexTable--toneSuccess","TableRow-child":"Polaris-IndexTable__TableRow--child",toneWarning:"Polaris-IndexTable--toneWarning",toneCritical:"Polaris-IndexTable--toneCritical",toneSubdued:"Polaris-IndexTable--toneSubdued","TableRow-subheader":"Polaris-IndexTable__TableRow--subheader","TableRow-selected":"Polaris-IndexTable__TableRow--selected","TableRow-hovered":"Polaris-IndexTable__TableRow--hovered","TableRow-disabled":"Polaris-IndexTable__TableRow--disabled",ZebraStriping:"Polaris-IndexTable__ZebraStriping",TableHeading:"Polaris-IndexTable__TableHeading","TableHeading-flush":"Polaris-IndexTable__TableHeading--flush","TableHeading-align-center":"Polaris-IndexTable--tableHeadingAlignCenter","TableHeading-align-end":"Polaris-IndexTable--tableHeadingAlignEnd","TableHeading-extra-padding-right":"Polaris-IndexTable--tableHeadingExtraPaddingRight","TableHeading-sortable":"Polaris-IndexTable__TableHeading--sortable",TableHeadingSortButton:"Polaris-IndexTable__TableHeadingSortButton",TableHeadingSortIcon:"Polaris-IndexTable__TableHeadingSortIcon","TableHeadingSortButton-heading-align-end":"Polaris-IndexTable--tableHeadingSortButtonHeadingAlignEnd","TableHeadingSortButton-heading-align-end-currently-sorted":"Polaris-IndexTable--tableHeadingSortButtonHeadingAlignEndCurrentlySorted","TableHeadingSortIcon-heading-align-end":"Polaris-IndexTable--tableHeadingSortIconHeadingAlignEnd","TableHeadingSortButton-heading-align-end-previously-sorted":"Polaris-IndexTable--tableHeadingSortButtonHeadingAlignEndPreviouslySorted","right-aligned-sort-button-slide-out":"Polaris-IndexTable--rightAlignedSortButtonSlideOut","reveal-right-aligned-sort-button-icon":"Polaris-IndexTable--revealRightAlignedSortButtonIcon",TableHeadingUnderline:"Polaris-IndexTable__TableHeadingUnderline",TableHeadingTooltipUnderlinePlaceholder:"Polaris-IndexTable__TableHeadingTooltipUnderlinePlaceholder","TableHeadingSortIcon-visible":"Polaris-IndexTable__TableHeadingSortIcon--visible",TableHeadingSortSvg:"Polaris-IndexTable__TableHeadingSortSvg",SortableTableHeadingWithCustomMarkup:"Polaris-IndexTable__SortableTableHeadingWithCustomMarkup",SortableTableHeaderWrapper:"Polaris-IndexTable__SortableTableHeaderWrapper",ColumnHeaderCheckboxWrapper:"Polaris-IndexTable__ColumnHeaderCheckboxWrapper",FirstStickyHeaderElement:"Polaris-IndexTable__FirstStickyHeaderElement","TableHeading-unselectable":"Polaris-IndexTable__TableHeading--unselectable","TableCell-flush":"Polaris-IndexTable__TableCell--flush","Table-sticky-scrolling":"Polaris-IndexTable--tableStickyScrolling","StickyTableHeader-sticky-scrolling":"Polaris-IndexTable--stickyTableHeaderStickyScrolling","TableHeading-last":"Polaris-IndexTable__TableHeading--last","Table-sticky-last":"Polaris-IndexTable--tableStickyLast","StickyTableHeader-sticky-last":"Polaris-IndexTable--stickyTableHeaderStickyLast","Table-sortable":"Polaris-IndexTable__Table--sortable",StickyTableHeader:"Polaris-IndexTable__StickyTableHeader","StickyTableHeader-isSticky":"Polaris-IndexTable__StickyTableHeader--isSticky",StickyTableHeadings:"Polaris-IndexTable__StickyTableHeadings","StickyTableHeading-second":"Polaris-IndexTable__StickyTableHeading--second",unselectable:"Polaris-IndexTable--unselectable","StickyTableHeading-second-scrolling":"Polaris-IndexTable--stickyTableHeadingSecondScrolling",ScrollLeft:"Polaris-IndexTable__ScrollLeft",ScrollRight:"Polaris-IndexTable__ScrollRight","ScrollRight-onboarding":"Polaris-IndexTable__ScrollRight--onboarding",SelectAllActionsWrapper:"Polaris-IndexTable__SelectAllActionsWrapper",SelectAllActionsWrapperWithPagination:"Polaris-IndexTable__SelectAllActionsWrapperWithPagination",SelectAllActionsWrapperSticky:"Polaris-IndexTable__SelectAllActionsWrapperSticky",SelectAllActionsWrapperAtEnd:"Polaris-IndexTable__SelectAllActionsWrapperAtEnd",SelectAllActionsWrapperAtEndAppear:"Polaris-IndexTable__SelectAllActionsWrapperAtEndAppear",BulkActionsWrapper:"Polaris-IndexTable__BulkActionsWrapper",BulkActionsWrapperVisible:"Polaris-IndexTable__BulkActionsWrapperVisible",PaginationWrapper:"Polaris-IndexTable__PaginationWrapper",PaginationWrapperScrolledPastTop:"Polaris-IndexTable__PaginationWrapperScrolledPastTop",ScrollBarContainer:"Polaris-IndexTable__ScrollBarContainer",ScrollBarContainerWithPagination:"Polaris-IndexTable__ScrollBarContainerWithPagination",ScrollBarContainerScrolledPastTop:"Polaris-IndexTable__ScrollBarContainerScrolledPastTop",ScrollBarContainerWithSelectAllActions:"Polaris-IndexTable__ScrollBarContainerWithSelectAllActions",ScrollBarContainerSelectAllActionsSticky:"Polaris-IndexTable__ScrollBarContainerSelectAllActionsSticky",scrollBarContainerCondensed:"Polaris-IndexTable--scrollBarContainerCondensed",scrollBarContainerHidden:"Polaris-IndexTable--scrollBarContainerHidden",ScrollBar:"Polaris-IndexTable__ScrollBar",disableTextSelection:"Polaris-IndexTable--disableTextSelection",EmptySearchResultWrapper:"Polaris-IndexTable__EmptySearchResultWrapper",condensedRow:"Polaris-IndexTable--condensedRow",CondensedList:"Polaris-IndexTable__CondensedList",HeaderWrapper:"Polaris-IndexTable__HeaderWrapper","StickyTable-condensed":"Polaris-IndexTable__StickyTable--condensed","StickyTableHeader-condensed":"Polaris-IndexTable__StickyTableHeader--condensed",ScrollBarContent:"Polaris-IndexTable__ScrollBarContent"};const Ve="All";let re=(function(t){return t.All="all",t.Page="page",t.Multi="multi",t.Single="single",t.Range="range",t})({});const $n=c.createContext(void 0),zn=c.createContext(void 0),Un=c.createContext(void 0);function Vn(){const t=c.useContext(zn);if(!t)throw new Error("Missing IndexProvider context");return t}function br(){const t=c.useContext(Un);if(!t)throw new Error("Missing IndexProvider context");return t}function Gn(){const t=c.useContext($n);if(!t)throw new Error("Missing IndexProvider context");return t}function xr({selectedItemsCount:t,itemCount:n,hasMoreItems:s,resourceName:a,defaultPaginatedSelectAllText:r}){const l=Ge(),p=!!t,u=t==="All"||t>0,d={singular:l.translate("Polaris.IndexProvider.defaultItemSingular"),plural:l.translate("Polaris.IndexProvider.defaultItemPlural")},m=a||d,y=R(),x=D(),v=E();let T="indeterminate";return!t||t===0?T=void 0:(t===Ve||t===n)&&(T=!0),{paginatedSelectAllText:y,bulkActionsLabel:x,bulkActionsAccessibilityLabel:v,resourceName:m,selectMode:u,bulkSelectState:T,selectable:p};function R(){if(!(!p||!s)&&t===Ve)return r||l.translate("Polaris.IndexProvider.allItemsSelected",{itemsLength:n,resourceNamePlural:m.plural.toLocaleLowerCase()})}function D(){const L=t===Ve?`${n}+`:t;return l.translate("Polaris.IndexProvider.selected",{selectedItemsCount:L})}function E(){const L=n,k=t===L;return L===1&&k?l.translate("Polaris.IndexProvider.a11yCheckboxDeselectAllSingle",{resourceNameSingular:m.singular}):L===1?l.translate("Polaris.IndexProvider.a11yCheckboxSelectAllSingle",{resourceNameSingular:m.singular}):k?l.translate("Polaris.IndexProvider.a11yCheckboxDeselectAllMultiple",{itemsLength:n,resourceNamePlural:m.plural}):l.translate("Polaris.IndexProvider.a11yCheckboxSelectAllMultiple",{itemsLength:n,resourceNamePlural:m.plural})}}function vr({onSelectionChange:t=()=>{}}){const n=c.useRef(null);return c.useCallback((a,r,l,p)=>{const u=n.current;if(re.Multi&&typeof p=="number"&&(n.current=p),a===re.Single||a===re.Multi&&(typeof u!="number"||typeof p!="number"))t(re.Single,r,l);else if(a===re.Multi){const d=Math.min(u,p),m=Math.max(u,p);t(a,r,[d,m])}else a===re.Page||a===re.All?t(a,r):a===re.Range&&t(re.Range,r,l)},[t])}function Sr({children:t,resourceName:n,loading:s,onSelectionChange:a,selectedItemsCount:r=0,itemCount:l,hasMoreItems:p,condensed:u,selectable:d=!0,paginatedSelectAllText:m}){const{paginatedSelectAllText:y,bulkActionsLabel:x,bulkActionsAccessibilityLabel:v,resourceName:T,selectMode:R,bulkSelectState:D}=xr({selectedItemsCount:r,itemCount:l,hasMoreItems:p,resourceName:n,defaultPaginatedSelectAllText:m}),E=vr({onSelectionChange:a}),L=c.useMemo(()=>({itemCount:l,selectMode:R&&d,selectable:d,resourceName:T,loading:s,paginatedSelectAllText:y,hasMoreItems:p,bulkActionsLabel:x,bulkActionsAccessibilityLabel:v,bulkSelectState:D,selectedItemsCount:r,condensed:u}),[l,R,d,T,s,y,p,x,v,D,r,u]),k=c.useMemo(()=>({selectable:d,selectMode:R&&d,condensed:u}),[u,R,d]);return o.createElement($n.Provider,{value:L},o.createElement(Un.Provider,{value:k},o.createElement(zn.Provider,{value:E},t)))}const hn=c.createContext({}),Er=c.createContext(void 0),Kn={scrollableContainer:null,canScrollLeft:!1,canScrollRight:!1},yr=c.createContext(Kn),Jn=c.memo(function({children:n,className:s,flush:a,colSpan:r,headers:l,scope:p,as:u="td",id:d}){const m=P(s,b.TableCell,a&&b["TableCell-flush"]);return o.createElement(u,{id:d,colSpan:r,headers:l,scope:p,className:m},n)});var Tr={Wrapper:"Polaris-IndexTable-Checkbox__Wrapper"};const kr=c.memo(function({accessibilityLabel:n}){const s=Ge(),{resourceName:a}=Gn(),{itemId:r,selected:l,disabled:p,onInteraction:u}=c.useContext(hn),d=n||s.translate("Polaris.IndexTable.selectItem",{resourceName:a.singular});return o.createElement(Cr,null,o.createElement("div",{className:Tr.Wrapper,onClick:u,onKeyUp:Pr},o.createElement(tt,{id:`Select-${r}`,label:d,labelHidden:!0,checked:l,disabled:p})))});function Cr({children:t}){const{position:n}=c.useContext(hn),s=c.useRef(null),a=c.useCallback(bt(()=>{if(n!==0||!s.current)return;const{width:l}=s.current.getBoundingClientRect();or("--pc-checkbox-offset",`${l}px`)}),[n]);c.useEffect(()=>{a()},[a]),c.useEffect(()=>{if(s.current)return window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[a]);const r=P(b.TableCell,b["TableCell-first"]);return o.createElement("td",{className:r,ref:s},t)}function Pr(){}const jr=c.memo(function({children:n,hideSelectable:s,selected:a,id:r,position:l,tone:p,disabled:u,selectionRange:d,rowType:m="data",accessibilityLabel:y,onNavigation:x,onClick:v}){const{selectable:T,selectMode:R,condensed:D}=br(),E=T&&!s,L=Vn(),{value:k,setTrue:F,setFalse:le}=rn(!1),Z=c.useCallback(I=>{I.stopPropagation();let ie=re.Single;if(u||!E||"key"in I&&I.key!==" "||!L)return;I.nativeEvent.shiftKey?ie=re.Multi:d&&(ie=re.Range),L(ie,!a,d??r,l)},[r,L,a,d,l,u,E]),$=c.useMemo(()=>({itemId:r,selected:a,position:l,onInteraction:Z,disabled:u}),[r,a,u,l,Z]),Q=c.useRef(null),M=c.useRef(!1),ke=c.useRef(null),z=c.useCallback(I=>{ke.current=I;const ie=I==null?void 0:I.querySelector("[data-primary-link]");ie&&(Q.current=ie)},[]),V=P(b.TableRow,m==="subheader"&&b["TableRow-subheader"],m==="child"&&b["TableRow-child"],E&&D&&b.condensedRow,a&&b["TableRow-selected"],k&&!D&&b["TableRow-hovered"],u&&b["TableRow-disabled"],p&&b[gt("tone",p)],!E&&!v&&!Q.current&&b["TableRow-unclickable"]);let J;(!u&&E||v||Q.current)&&(J=I=>{if(m!=="subheader"&&!(!ke.current||M.current)){if(I.stopPropagation(),I.preventDefault(),v){v();return}if(Q.current&&!R){M.current=!0;const{ctrlKey:ie,metaKey:G}=I.nativeEvent;if(x&&x(r),(ie||G)&&Q.current instanceof HTMLAnchorElement){M.current=!1,window.open(Q.current.href,"_blank");return}Q.current.dispatchEvent(new MouseEvent(I.type,I.nativeEvent))}else M.current=!1,Z(I)}});const de=D?"li":"tr",ue=s?o.createElement(Jn,null):o.createElement(kr,{accessibilityLabel:y});return o.createElement(hn.Provider,{value:$},o.createElement(Er.Provider,{value:k},o.createElement(de,{key:r,id:r,className:V,onMouseEnter:F,onMouseLeave:le,onClick:J,ref:z},T?ue:null,n)))});function _n(t,n){return t?Array.from(t.querySelectorAll(n)):[]}var wr={ScrollContainer:"Polaris-IndexTable-ScrollContainer"};function Ar({children:t,scrollableContainerRef:n,onScroll:s}){c.useEffect(()=>{n.current&&n.current.dispatchEvent(new Event("scroll"))},[n]);const[a,r]=c.useState(Kn),l=c.useCallback(bt(()=>{if(!n.current)return;const p=n.current.scrollWidth-n.current.offsetWidth,u=n.current.scrollLeft>0,d=n.current.scrollLeft<p;s(u,d),r({scrollableContainer:n.current,canScrollLeft:u,canScrollRight:d})},40,{trailing:!0,leading:!0,maxWait:40}),[s,n]);return o.createElement(yr.Provider,{value:a},o.createElement("div",{className:wr.ScrollContainer,ref:n,onScroll:l},t))}const Ir=16,_r=300;function Nr({headings:t,bulkActions:n=[],promotedBulkActions:s=[],children:a,emptyState:r,sort:l,paginatedSelectAllActionText:p,lastColumnSticky:u=!1,sortable:d,sortDirection:m,defaultSortDirection:y="descending",sortColumnIndex:x,onSort:v,sortToggleLabels:T,hasZebraStriping:R,pagination:D,...E}){const{loading:L,bulkSelectState:k,resourceName:F,bulkActionsAccessibilityLabel:le,selectMode:Z,selectable:$=E.selectable,paginatedSelectAllText:Q,itemCount:M,hasMoreItems:ke,selectedItemsCount:z,condensed:V}=Gn(),J=Vn(),de=Ge(),{value:ue,toggle:I}=rn(!1),ie=c.useRef({top:0,left:0}),G=c.useRef([]),X=c.useRef(null),ee=c.useRef(null),Ke=c.useRef(null),pe=c.useRef(null),[U,Ce]=c.useState(!1),[Je,_e]=c.useState(null),[_,A]=c.useState(!0),H=c.useRef([]),Ee=c.useRef([]),te=c.useRef(null),Ne=c.useRef(null),at=c.useRef(null),me=c.useRef(null),dt=c.useRef(null),Xe=c.useRef(!1),ut=c.useRef(!1),pt=c.useRef(x),Le=c.useRef(!1),ht=c.useRef(0),ge=c.useRef(!1);z!==ht.current&&(Le.current=!0,ht.current=z),!ge.current&&z!==0&&(ge.current=!0);const Me=c.useCallback(S=>{S!==null&&!U&&Ce(!0),Ke.current=S},[U]),Fe=c.useCallback(()=>{J(z===Ve?re.Page:re.All,!0)},[J,z]),Be=c.useMemo(()=>bt(()=>{var w,ce;if(!ee.current||!X.current)return;const S=X.current.getBoundingClientRect();ie.current={top:S.top,left:S.left},G.current=H.current.map(he=>({offsetWidth:he.offsetWidth||0,offsetLeft:he.offsetLeft||0})),H.current.length!==0&&($&&H.current.length>1&&(H.current[1].style.left=`${G.current[0].offsetWidth}px`,(w=Ee.current)!=null&&w.length&&(Ee.current[1].style.left=`${G.current[0].offsetWidth}px`)),(ce=Ee.current)!=null&&ce.length&&Ee.current.forEach((he,Ae)=>{var We;he.style.minWidth=`${((We=G.current[Ae])==null?void 0:We.offsetWidth)||0}px`}))}),[$]),Oe=c.useCallback(()=>{var S,w;me.current&&ee.current&&U&&(me.current.style.setProperty("--pc-index-table-scroll-bar-content-width",`${ee.current.offsetWidth-Ir}px`),A(((S=dt.current)==null?void 0:S.offsetWidth)===((w=ee.current)==null?void 0:w.offsetWidth)))},[U]),se=c.useCallback(bt(Oe,_r,{trailing:!0}),[Oe]),[xt,vt]=c.useState(!0),He=c.useCallback(bt(()=>{if(!u||!ee.current||!X.current)return;const S=ee.current.getBoundingClientRect(),w=X.current.getBoundingClientRect();vt(S.width>w.width)}),[u]);c.useEffect(()=>{He()},[He]);const[$e,Wt]=c.useState(!0),rt=c.useCallback(()=>{if(!X.current||!H.current.length)return;const S=X.current.getBoundingClientRect(),w=$?H.current[0].getBoundingClientRect().width:0,ce=H.current[$?1:0].getBoundingClientRect().width,he=$?H.current.length>2:1,Ae=u&&he?H.current[H.current.length-1].getBoundingClientRect().width:0;Wt(S.width>ce+w+Ae+100)},[u,$]);c.useEffect(()=>{U&&rt()},[rt,U]);const St=c.useCallback(()=>{var S;(S=me.current)==null||S.style.setProperty("--pc-index-table-scroll-bar-content-width","0px"),Be(),se(),He(),rt()},[Be,se,He,rt]),Rt=c.useCallback((S,w)=>{!X.current||!me.current||(Xe.current||(ut.current=!0,me.current.scrollLeft=X.current.scrollLeft),Xe.current=!1,at.current&&(at.current.scrollLeft=X.current.scrollLeft),(S&&!ue||!S&&ue)&&I(),vt(w))},[ue,I]),Dt=c.useCallback(()=>{!X.current||!me.current||(ut.current||(Xe.current=!0,X.current.scrollLeft=me.current.scrollLeft),ut.current=!1)},[]);Ca(()=>{H.current=_n(ee.current,"[data-index-table-heading]"),Ee.current=_n(te.current,"[data-index-table-sticky-heading]"),Be()},[t,Be,Ne,U]),c.useEffect(()=>{Oe(),_e(V?pe.current:ee.current)},[U,Oe,V]);const Ft=t.map((S,w)=>Ct(S,w,"th",{"data-index-table-heading":!0},S.id)),Ot=t.map((S,w)=>Ct(S,w,"div",{"data-index-table-sticky-heading":!0})),[Et,yt]=c.useState(z===Ve?`${M}+`:z);c.useEffect(()=>{(z===Ve||z>0)&&yt(z===Ve?`${M}+`:z)},[z,M]);const $t=de.translate("Polaris.IndexTable.selected",{selectedItemsCount:Et}),Tt=c.useCallback(()=>{J(re.Page,!k||k==="indeterminate")},[k,J]),kt=Zn(),i=o.createElement("div",{className:P(b.LoadingPanel,L&&b.LoadingPanelEntered)},o.createElement("div",{className:b.LoadingPanelRow},o.createElement(ln,{size:"small"}),o.createElement("span",{className:b.LoadingPanelText},de.translate("Polaris.IndexTable.resourceLoadingAccessibilityLabel",{resourceNamePlural:F.plural.toLocaleLowerCase()})))),f=P(b.StickyTable,ue&&b["StickyTable-scrolling"],V&&b["StickyTable-condensed"]),h=!V||z,g=h?s:[],C=h?n:[],B=o.createElement("div",{className:f,role:"presentation"},o.createElement(Pa,{boundingElement:Je},S=>{const w=P(b.StickyTableHeader,S&&b["StickyTableHeader-isSticky"],$e&&b["StickyTableHeader-sticky"],ue&&b["StickyTableHeader-scrolling"],$e&&u&&b["StickyTableHeader-sticky-last"],$e&&u&&xt&&b["StickyTableHeader-sticky-scrolling"]),ce=P(b.BulkActionsWrapper,Z&&b.BulkActionsWrapperVisible,V&&b["StickyTableHeader-condensed"],S&&b["StickyTableHeader-isSticky"]),he=h&&!V?o.createElement("div",{className:ce},o.createElement($a,{selectMode:Z,onToggleAll:Tt,paginatedSelectAllText:Q,paginatedSelectAllAction:kt,accessibilityLabel:le,selected:k,promotedActions:g,actions:C,onSelectModeToggle:V?Qn:void 0,label:$t,buttonSize:"micro"})):null,Ae=V?o.createElement("div",{className:P(b.HeaderWrapper,(!$||V)&&b.unselectable)},i,l):o.createElement("div",{className:w,ref:te},i,o.createElement("div",{className:b.StickyTableHeadings,ref:at},Ot));return o.createElement(o.Fragment,null,Ae,he)})),N=P(b.ScrollBarContainer,D&&b.ScrollBarContainerWithPagination,V&&b.scrollBarContainerCondensed,_&&b.scrollBarContainerHidden),q=P(ee.current&&U&&b.ScrollBarContent),oe=M>0?o.createElement(ja,{onMount:Oe},o.createElement("div",{className:N,ref:dt},o.createElement("div",{onScroll:Dt,className:b.ScrollBar,ref:me},o.createElement("div",{className:q})))):null,be=d==null?void 0:d.some(S=>S),xe=P(b.Table,ue&&b["Table-scrolling"],Z&&b.disableTextSelection,!$&&b["Table-unselectable"],$e&&b["Table-sticky"],be&&b["Table-sortable"],$e&&u&&b["Table-sticky-last"],$e&&u&&xt&&b["Table-sticky-scrolling"],R&&b.ZebraStriping),we=r||o.createElement(Xa,{title:de.translate("Polaris.IndexTable.emptySearchTitle",{resourceNamePlural:F.plural}),description:de.translate("Polaris.IndexTable.emptySearchDescription"),withIllustration:!0}),ze=o.createElement(o.Fragment,null,o.createElement(Wn,{event:"resize",handler:St}),B),qe=P(b.CondensedList,R&&b.ZebraStriping),O=V?o.createElement(o.Fragment,null,ze,o.createElement("ul",{"data-selectmode":!!Z,className:qe,ref:pe},a)):o.createElement(o.Fragment,null,ze,o.createElement(Ar,{scrollableContainerRef:X,onScroll:Rt},o.createElement("table",{ref:ee,className:xe},o.createElement("thead",null,o.createElement("tr",{className:b.HeadingRow},Ft)),o.createElement("tbody",{ref:Me},a)))),Pe=M>0?O:o.createElement("div",{className:b.EmptySearchResultWrapper},we),ye=D?o.createElement("div",{className:b.PaginationWrapper},o.createElement(Ea,Object.assign({type:"table"},D))):null;return o.createElement(o.Fragment,null,o.createElement("div",{className:b.IndexTable},o.createElement("div",{className:b.IndexTableWrapper},!V&&i,Pe,oe,ye)));function Ct(S,w,ce,he,Ae){const We=w===0,lt=w===t.length-1,Re=d==null?void 0:d.some(At=>At===!0),jt=S.alignment||"start",zt=P(b.TableHeading,jt==="center"&&b["TableHeading-align-center"],jt==="end"&&b["TableHeading-align-end"],Re&&b["TableHeading-sortable"],We&&b["TableHeading-second"],lt&&!S.hidden&&b["TableHeading-last"],!$&&b["TableHeading-unselectable"],S.flush&&b["TableHeading-flush"]),Ut=$!==!1&&We&&G.current&&G.current.length>0?{left:G.current[0].offsetWidth}:void 0,Ye=o.createElement(ce,Object.assign({id:Ae,className:zt,key:Lr(S),style:Ut},he),qn(S,w));if(w!==0||!$)return Ye;const wt=P(b.TableHeading,Re&&b["TableHeading-sortable"],w===0&&b["TableHeading-first"]);return[o.createElement(ce,Object.assign({className:wt,key:`${S}-${w}`},he),Pt()),Ye]}function Pt(){return o.createElement("div",{className:b.ColumnHeaderCheckboxWrapper},o.createElement(tt,{label:de.translate("Polaris.IndexTable.selectAllLabel",{resourceNamePlural:F.plural}),labelHidden:!0,onChange:Yn,checked:k}))}function Xn(S,w){Le.current=!1,ge.current=!1,pt.current=x,v==null||v(S,w)}function qn(S,w){let ce;const he={width:S.tooltipWidth??"default",activatorWrapper:"div",dismissOnMouseOut:!0,persistOnClick:S.tooltipPersistsOnClick},Ae={...he,padding:"400",borderRadius:"200",content:S.tooltipContent,preferredPosition:"above"},We=o.createElement(W,{as:"span",variant:"bodySm",fontWeight:"medium",visuallyHidden:S.hidden},S.title);S.new?ce=o.createElement(sn,{wrap:!1,alignment:"center"},We,o.createElement(Y,{tone:"new"},de.translate("Polaris.IndexTable.onboardingBadgeText"))):ce=We;const lt={"--pc-index-table-heading-extra-padding-right":S.paddingBlockEnd?`var(--p-space-${S.paddingBlockEnd})`:"0"};if(d!=null&&d[w]){const Re=w===x,jt=!Re&&w===pt.current,zt=Le.current||!ge.current&&z!==0,Ut=m==="ascending";let Ye=S.defaultSortDirection??y,wt=Ye==="ascending"?vn:Sn;Re&&(Ye=Ut?"descending":"ascending",wt=m==="ascending"?vn:Sn);const Vt=o.createElement("span",{className:P(b.TableHeadingSortIcon,(S==null?void 0:S.alignment)==="end"&&b["TableHeadingSortIcon-heading-align-end"],Re&&b["TableHeadingSortIcon-visible"])},o.createElement(wt,{focusable:"false","aria-hidden":"true",className:b.TableHeadingSortSvg})),At={onClick:()=>Xn(w,Ye),className:P(b.TableHeadingSortButton,!Re&&(S==null?void 0:S.alignment)==="end"&&b["TableHeadingSortButton-heading-align-end"],Re&&(S==null?void 0:S.alignment)==="end"&&b["TableHeadingSortButton-heading-align-end-currently-sorted"],jt&&!zt&&(S==null?void 0:S.alignment)==="end"&&b["TableHeadingSortButton-heading-align-end-previously-sorted"]),tabIndex:Z?-1:0},fn=o.createElement(Yt,At,Vt,o.createElement("span",{className:P(T&&Z&&S.tooltipContent&&b.TableHeadingTooltipUnderlinePlaceholder)},ce));if(!T||Z)return o.createElement("div",{className:b.SortableTableHeadingWithCustomMarkup},fn);const ea=Re?m:Ye,mn=T[w][ea];if(!S.tooltipContent)return o.createElement("div",{style:lt,className:P(S.paddingBlockEnd&&b["TableHeading-extra-padding-right"])},o.createElement(et,Object.assign({},he,{content:mn,preferredPosition:"above"}),fn));if(S.tooltipContent)return o.createElement("div",{className:P(b.SortableTableHeadingWithCustomMarkup,S.paddingBlockEnd&&b["TableHeading-extra-padding-right"]),style:lt},o.createElement(Yt,At,o.createElement(et,Ae,o.createElement("span",{className:b.TableHeadingUnderline},ce)),o.createElement(et,Object.assign({},he,{content:mn,preferredPosition:"above"}),Vt)))}return S.tooltipContent?o.createElement("div",{style:lt,className:P(S.paddingBlockEnd&&b["TableHeading-extra-padding-right"])},o.createElement(et,Object.assign({},Ae,{activatorWrapper:"span"}),o.createElement("span",{className:P(b.TableHeadingUnderline,b.SortableTableHeaderWrapper)},ce))):o.createElement("div",{style:lt,className:P(S.paddingBlockEnd&&b["TableHeading-extra-padding-right"])},ce)}function Yn(S){J(re.Page,S)}function Zn(){if(!$||!ke)return;const S=p??de.translate("Polaris.IndexTable.selectAllItems",{itemsLength:M,resourceNamePlural:F.plural.toLocaleLowerCase()});return{content:z===Ve?de.translate("Polaris.IndexTable.undo"):S,onAction:Fe}}function Qn(){J(re.All,!1)}}function Lr(t){return t.id?t.id:typeof t.title=="string"?t.title:""}function ne({children:t,selectable:n=!0,itemCount:s,selectedItemsCount:a=0,resourceName:r,loading:l,hasMoreItems:p,condensed:u,onSelectionChange:d,paginatedSelectAllText:m,...y}){return o.createElement(o.Fragment,null,o.createElement(Sr,{selectable:n&&!u,itemCount:s,selectedItemsCount:a,resourceName:r,loading:l,hasMoreItems:p,condensed:u,onSelectionChange:d,paginatedSelectAllText:m},o.createElement(Nr,y,t)))}ne.Cell=Jn;ne.Row=jr;const Bt=class Bt{static set(n,s,a=Bt.DEFAULT_TTL){if(typeof window>"u")return;const r={data:s,timestamp:Date.now(),expiresAt:Date.now()+a};try{sessionStorage.setItem(n,JSON.stringify(r))}catch(l){console.warn("キャッシュ保存に失敗（Shopify認証影響なし）:",l)}}static get(n){if(typeof window>"u")return null;try{const s=sessionStorage.getItem(n);if(!s)return null;const a=JSON.parse(s);return Date.now()>a.expiresAt?(sessionStorage.removeItem(n),null):a.data}catch(s){return console.warn("キャッシュ取得に失敗:",s),sessionStorage.removeItem(n),null}}static clear(n){typeof window>"u"||sessionStorage.removeItem(n)}static clearAll(){typeof window>"u"||sessionStorage.clear()}static isExpired(n){if(typeof window>"u")return!0;try{const s=sessionStorage.getItem(n);if(!s)return!0;const a=JSON.parse(s);return Date.now()>a.expiresAt}catch{return!0}}static getInfo(n){if(typeof window>"u")return null;try{const s=sessionStorage.getItem(n);if(!s)return null;const a=JSON.parse(s);return{timestamp:a.timestamp,expiresAt:a.expiresAt}}catch{return null}}};gn(Bt,"DEFAULT_TTL",300*1e3);let ct=Bt;const _t={PRODUCTS:"shopify_products_cache"};function qr({formAction:t,actionResult:n}){return n!=null&&n.updateResults||n!=null&&n.message,!0}function Mr({productId:t,onOptimistic:n,scheduleRevalidate:s}){const a=qt(),r=a.state!=="idle";return c.useEffect(()=>{var l;a.state==="idle"&&((l=a.data)!=null&&l.success)&&(s==null||s())},[a.state,a.data,s]),e.jsxs(a.Form,{method:"post",replace:!0,children:[e.jsx("input",{type:"hidden",name:"action",value:"unselectProducts"}),e.jsx("input",{type:"hidden",name:"productId",value:t}),e.jsx(Se,{size:"micro",variant:"tertiary",tone:"critical",loading:r,disabled:r,onClick:l=>{l.preventDefault(),n==null||n(t);const p=new FormData(l.currentTarget.form);a.submit(p,{method:"post"})},children:"解除"})]})}function Br(t,n,s="all"){let a=t;return s==="k18"&&(a=t.filter(r=>r.title.includes("K18")||r.title.includes("18金"))),n&&(a=a.filter(r=>r.title.toLowerCase().includes(n.toLowerCase())||r.handle.toLowerCase().includes(n.toLowerCase()))),a}function Hr(t,n,s=.93){const a=t*(1+n),r=t*s,l=Math.max(a,r);return n>=0?Math.ceil(l/10)*10:Math.floor(l/10)*10}function Wr({products:t,collections:n,goldPrice:s,platinumPrice:a,selectedProductIds:r,savedSelectedProducts:l,selectedCollectionIds:p,savedSelectedCollections:u,shopSetting:d,forceRefresh:m,cacheTimestamp:y}){var Tt,kt;const x=qt(),v=qt(),T=la(),R=c.useMemo(()=>{const i={};return(l||[]).forEach(f=>{i[f.productId]=f.metalType}),i},[l]),D=c.useMemo(()=>{const i={};return(u||[]).forEach(f=>{i[f.collectionId]=f.metalType}),i},[u]);c.useMemo(()=>new Set((l||[]).map(i=>i.productId)),[l]),c.useMemo(()=>new Set((u||[]).map(i=>i.collectionId)),[u]);const[E,L]=c.useState([]),[k,F]=c.useState({}),[le,Z]=c.useState(""),[$,Q]=c.useState("all"),[M,ke]=c.useState("products"),[z,V]=c.useState("all"),[J,de]=c.useState((d==null?void 0:d.minPricePct)||93),[ue,I]=c.useState(!1),[ie,G]=c.useState([]),[X,ee]=c.useState(!1),[Ke,pe]=c.useState(null),[U,Ce]=c.useState(p||[]),[Je,_e]=c.useState(D||{}),[_,A]=c.useState("plus"),[H,Ee]=c.useState(.1),[te,Ne]=c.useState([]),[at,me]=c.useState({}),[dt,Xe]=c.useState(0),[ut,pt]=c.useState({}),[Le,ht]=c.useState(()=>new Set((l||[]).map(i=>i.productId))),ge=c.useCallback(i=>{ht(f=>new Set([...f,...i]))},[]),Me=c.useCallback(i=>{ht(f=>{const h=new Set(f);return i.forEach(g=>h.delete(g)),h})},[]),Fe=c.useRef(null),Be=c.useCallback(()=>{Fe.current&&clearTimeout(Fe.current),Fe.current=setTimeout(()=>{T.revalidate(),Fe.current=null},500)},[T]);c.useEffect(()=>()=>{Fe.current&&clearTimeout(Fe.current)},[]),c.useEffect(()=>{if(t&&t.length>0&&(ct.set(_t.PRODUCTS,t),ee(!1),pe(new Date(y)),r&&r.length>0)){const i=t.filter(f=>r.includes(f.id));if(L(i),l&&l.length>0){const f={};l.forEach(h=>{f[h.productId]=h.metalType}),F(f)}}},[t,r,m,y]),c.useEffect(()=>{if(console.log("🔍 Updater state changed:",{state:v.state,data:v.data}),v.state==="idle"&&v.data&&v.data.updateResults&&v.data.summary){console.log("✅ Manual update completed:",v.data);const i={};if(v.data.updateResults.forEach(f=>{f.success&&f.confirmedPrice!==void 0&&(i[f.variantId]=f.confirmedPrice)}),Object.keys(i).length>0){console.log("🎯 Applying confirmed prices from server:",i),me(g=>({...g,...i}));const f=Date.now(),h=Object.fromEntries(Object.entries(i).map(([g,C])=>[g,{price:C,until:f+180*1e3}]));pt(g=>({...g,...h}))}Ne([])}},[v.state,v.data]),c.useEffect(()=>{const i=setInterval(()=>{const f=Date.now();pt(h=>{const g={...h};let C=!1;for(const[B,N]of Object.entries(g))N.until<=f&&(delete g[B],C=!0,console.log(`🧹 Cleaned expired overlay for variant: ${B}`));return C?g:h})},5e3);return()=>clearInterval(i)},[]),c.useEffect(()=>{if(x.state==="idle"&&x.data){if(x.data.savedProducts){const i=x.data.savedProducts.map(f=>f.productId);L(f=>f.filter(h=>!i.includes(h.id))),ge(i)}if(x.data.savedCollection){const{collectionId:i,metalType:f}=x.data.savedCollection;Ce(h=>[...h.filter(g=>g!==i),i]),_e(h=>({...h,[i]:f}))}if(x.data.unselectedProducts){const i=new Set(x.data.unselectedProducts);L(f=>f.filter(h=>!i.has(h.id))),F(f=>{const h={...f};return x.data.unselectedProducts.forEach(g=>delete h[g]),h}),Me(x.data.unselectedProducts),Be()}if(x.data.unselectedCollection){const i=x.data.unselectedCollection;Ce(f=>f.filter(h=>h!==i)),_e(f=>{const h={...f};return delete h[i],h}),Be()}}},[x.state,x.data,ge,Me,Be]);const Oe=c.useCallback(()=>{ct.clear(_t.PRODUCTS),ee(!1),T.revalidate()},[T]),se=Br(t,le,$),xt=c.useCallback(async(i,f)=>{const h=Date.now()+1e4;for(;Date.now()<h;)try{if((await(await fetch("/api/verify-variants",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({variantIds:i,expectedPrices:f}),cache:"no-store"})).json()).verified)return!0;await new Promise(B=>setTimeout(B,500))}catch(g){console.error("Verification polling error:",g);break}return!1},[]);c.useCallback(async i=>{const f=Date.now()+1e4;for(;Date.now()<f;)try{const h=Object.keys(i),g=[];h.forEach(N=>{var oe,be;const q=se.find(xe=>xe.id===N);(be=(oe=q==null?void 0:q.variants)==null?void 0:oe.edges)!=null&&be[0]&&g.push(q.variants.edges[0].node.id)});const B=await(await fetch(`/api/variants?ids=${g.join(",")}`,{cache:"no-store"})).json();if(B.variants&&B.variants.every(q=>{const oe=i[q.productId];return oe&&Math.abs(q.price-oe)<1}))return console.log("✅ All prices verified on server"),!0;await new Promise(N=>setTimeout(N,500))}catch(h){console.error("Polling error:",h);break}return console.log("⏰ Polling timeout reached"),!1},[se]);const vt=c.useCallback((i,f)=>{const h=t.find(g=>g.id===i);f?L(g=>[...g,h]):(L(g=>g.filter(C=>C.id!==i)),F(g=>{const C={...g};return delete C[i],C}))},[t]),He=c.useCallback(i=>{i?L(se):(L([]),F({}))},[se]),$e=c.useCallback((i,f)=>{if(f==="none")return;F(g=>({...g,[i]:f})),ge([i]);const h=new FormData;h.append("action","saveSingleProduct"),h.append("productId",i),h.append("metalType",f),x.submit(h,{method:"post"})},[x,ge]),Wt=c.useCallback((i,f)=>{if(Ce(h=>f?[...new Set([...h,i])]:h.filter(g=>g!==i)),!f){const h=new FormData;h.append("action","unselectCollection"),h.append("collectionId",i),x.submit(h,{method:"post"})}},[x]),rt=c.useCallback((i,f)=>{if(f==="none")return;_e(g=>({...g,[i]:f}));const h=new FormData;h.append("action","saveCollectionSelection"),h.append("collectionId",i),h.append("metalType",f),x.submit(h,{method:"post"})},[x]),St=c.useCallback(i=>{const f=E.filter(C=>!r.includes(C.id));if(f.length===0)return;const h={};f.forEach(C=>{h[C.id]=i}),F(C=>({...C,...h})),ge(f.map(C=>C.id));const g=new FormData;g.append("action","saveSelection"),f.forEach(C=>{g.append("productId",C.id),g.append("metalType",i)}),x.submit(g,{method:"post"})},[E,r,x,ge]),Rt=c.useCallback(()=>{const i=E.filter(h=>!k[h.id]);if(i.length>0){alert(`以下の商品の金属種別を選択してください：
${i.map(h=>h.title).join(`
`)}`);return}ge(E.map(h=>h.id));const f=new FormData;f.append("action","saveSelection"),E.forEach(h=>{f.append("productId",h.id),f.append("metalType",k[h.id])}),x.submit(f,{method:"post"})},[E,k,x,ge]);c.useCallback(i=>{L(h=>h.filter(g=>g.id!==i)),F(h=>{const g={...h};return delete g[i],g}),Me([i]);const f=new FormData;f.append("action","unselectProducts"),f.append("productId",i),x.submit(f,{method:"post"})},[x,Me]);const Dt=c.useCallback(()=>{const i=E.filter(h=>Le.has(h.id)).map(h=>h.id);if(i.length===0)return;Me(i),L(h=>h.filter(g=>!i.includes(g.id))),F(h=>{const g={...h};return i.forEach(C=>delete g[C]),g});const f=new FormData;f.append("action","unselectProducts"),i.forEach(h=>f.append("productId",h)),x.submit(f,{method:"post"})},[E,Le,Me,x]),Ft=c.useCallback(()=>{if(E.length===0)return;const i=E.map(f=>{const h=k[f.id]||"gold",g=h==="gold"?s:a;return g?{...f,metalType:h,variants:f.variants.edges.map(C=>{var oe;const B=C.node,N=Number(((oe=B.price)==null?void 0:oe.amount)??0),q=Hr(N,g.ratio,J/100);return{...B,currentPrice:N,newPrice:q,priceChange:q-N,changed:q!==N}})}:{...f,metalType:h,error:`${h==="gold"?"金":"プラチナ"}価格データが取得できません`,variants:f.variants.edges.map(C=>({...C.node,currentPrice:parseFloat(C.node.price),newPrice:parseFloat(C.node.price),priceChange:0,changed:!1}))}});G(i),I(!0)},[E,s,a,k,J]),Ot=c.useCallback(()=>{const i=E.some(g=>(k[g.id]||"gold")==="gold"),f=E.some(g=>k[g.id]==="platinum");if(i&&!s||f&&!a)return;const h=E.map(g=>g.id);v.submit({action:"updatePrices",selectedProductIds:JSON.stringify(h),minPriceRate:J.toString()},{method:"post"}),I(!1)},[E,s,a,k,J,v]),Et=c.useCallback((i,f)=>{Ne(f?h=>[...h,i]:h=>h.filter(g=>g!==i))},[]),yt=c.useCallback(i=>{Ne(i?se.map(f=>f.id):[])},[se]),$t=c.useCallback(()=>{if(te.length===0)return;const i=_==="plus"?H/100:-(H/100);console.log("🚀 Starting manual price update:",{manualSelectedProducts:te,adjustmentRatio:i});const f={};te.forEach(B=>{var q,oe;const N=se.find(be=>be.id===B);console.log("🔍 Product found for optimistic update:",{productId:B,product:N==null?void 0:N.title,variants:N==null?void 0:N.variants}),((oe=(q=N==null?void 0:N.variants)==null?void 0:q.edges)==null?void 0:oe.length)>0?N.variants.edges.forEach(({node:be})=>{const xe=Math.round(Number(be.price??0));function we(qe,O,Pe=.93){const ye=qe*(1+O),Ct=qe*Pe,Pt=Math.max(ye,Ct);return O>=0?Math.ceil(Pt/10)*10:Math.floor(Pt/10)*10}const ze=we(xe,i);console.log("💰 Variant price calculation:",{variantId:be.id,currentPrice:xe,adjustmentRatio:i,newPrice:ze}),f[be.id]=ze}):console.warn("⚠️ No variants found for product:",B)}),me(B=>{const N={...B,...f};return console.log("✨ Optimistic price updates applied:",{previous:B,updates:f,newState:N}),N}),v.submit({action:"manualUpdatePrices",selectedProductIds:JSON.stringify(te),adjustmentRatio:i.toString()},{method:"post"});const h=Object.keys(f).map(B=>B);xt(h,f).then(B=>{B?(console.log("✅ Server verification successful - extending TTL"),setTimeout(()=>{console.log("🔄 Clearing optimistic updates after verification"),me({}),ct.clear(_t.PRODUCTS),T.revalidate()},6e4)):(console.log("⚠️ Server verification failed - extending protection"),setTimeout(()=>{me({})},5e3))});let g=10;Xe(g);const C=setInterval(()=>{g--,Xe(g),g<=0&&(clearInterval(C),Xe(0))},1e3)},[te,_,H,v,se,T]);return e.jsx(Hn,{fullWidth:!0,title:"商品価格自動調整",subtitle:M==="products"?`${se.length}件の商品（全${t.length}件）`:`${(n==null?void 0:n.length)??0}件のコレクション`,primaryAction:{content:"価格調整プレビュー",onAction:Ft,disabled:M!=="products"||E.length===0||E.some(i=>(k[i.id]||"gold")==="gold")&&!s||E.some(i=>k[i.id]==="platinum")&&!a,loading:M==="products"&&v.state==="submitting"},secondaryActions:[{content:"商品を再読み込み",icon:Nt,onAction:Oe,loading:T.state==="loading"}],children:e.jsxs(Te,{children:[e.jsxs(Te.Section,{children:[e.jsxs(Te,{children:[e.jsxs(Te.Section,{children:[s&&e.jsx(ve,{children:e.jsx("div",{style:{padding:"16px",background:"#fbbf24",borderRadius:"8px"},children:e.jsxs(fe,{gap:"300",children:[e.jsxs(j,{align:"space-between",children:[e.jsxs(j,{gap:"200",blockAlign:"center",children:[e.jsx("span",{style:{fontSize:"20px"},children:"🥇"}),e.jsx("h3",{style:{color:"white"},children:"田中貴金属 金価格情報"})]}),e.jsx(Y,{tone:s.changeDirection==="up"?"critical":s.changeDirection==="down"?"success":"info",children:s.changeDirection==="up"?"上昇":s.changeDirection==="down"?"下落":"変動なし"})]}),e.jsxs(j,{gap:"400",wrap:!0,children:[e.jsxs("div",{children:[e.jsx("p",{style:{color:"white",margin:0,fontSize:"12px"},children:"店頭小売価格（税込）"}),e.jsx("h4",{style:{color:"white",margin:"4px 0"},children:s.retailPriceFormatted})]},"gold-retail"),e.jsxs("div",{children:[e.jsx("p",{style:{color:"white",margin:0,fontSize:"12px"},children:"小売価格前日比"}),e.jsx("h4",{style:{color:"white",margin:"4px 0"},children:s.change})]},"gold-change"),e.jsxs("div",{children:[e.jsx("p",{style:{color:"white",margin:0,fontSize:"12px"},children:"店頭買取価格（税込）"}),e.jsx("h4",{style:{color:"white",margin:"4px 0"},children:s.buyPriceFormatted||"取得失敗"})]},"gold-buy"),e.jsxs("div",{children:[e.jsx("p",{style:{color:"white",margin:0,fontSize:"12px"},children:"買取価格前日比"}),e.jsx("h4",{style:{color:"white",margin:"4px 0"},children:s.buyChangePercent||"0.00%"})]},"gold-buy-change"),e.jsxs("div",{children:[e.jsx("p",{style:{color:"white",margin:0,fontSize:"12px"},children:"価格調整率"}),e.jsxs("h4",{style:{color:"white",margin:"4px 0"},children:[s.percentage,"%"]})]},"gold-ratio")]}),e.jsx("div",{style:{marginTop:"12px"},children:e.jsxs("p",{style:{color:"white",margin:0,fontSize:"11px"},children:["出典: ",e.jsx("a",{href:"https://gold.tanaka.co.jp/commodity/souba/",target:"_blank",rel:"noopener noreferrer",style:{color:"white",textDecoration:"underline"},children:"田中貴金属工業株式会社"})]})}),e.jsxs("p",{style:{color:"white",margin:0,fontSize:"12px"},suppressHydrationWarning:!0,children:["最終更新: ",new Date(s.lastUpdated).toLocaleString("ja-JP")]})]})})}),!s&&e.jsx(je,{tone:"critical",children:"金価格情報の取得に失敗しました。"})]}),e.jsxs(Te.Section,{children:[a&&e.jsx(ve,{children:e.jsx("div",{style:{padding:"16px",background:"#94a3b8",borderRadius:"8px"},children:e.jsxs(fe,{gap:"300",children:[e.jsxs(j,{align:"space-between",children:[e.jsxs(j,{gap:"200",blockAlign:"center",children:[e.jsx("span",{style:{fontSize:"20px"},children:"🥈"}),e.jsx("h3",{style:{color:"white"},children:"田中貴金属 プラチナ価格情報"})]}),e.jsx(Y,{tone:a.changeDirection==="up"?"critical":a.changeDirection==="down"?"success":"info",children:a.changeDirection==="up"?"上昇":a.changeDirection==="down"?"下落":"変動なし"})]}),e.jsxs(j,{gap:"400",wrap:!0,children:[e.jsxs("div",{children:[e.jsx("p",{style:{color:"white",margin:0,fontSize:"12px"},children:"店頭小売価格（税込）"}),e.jsx("h4",{style:{color:"white",margin:"4px 0"},children:a.retailPriceFormatted})]},"platinum-retail"),e.jsxs("div",{children:[e.jsx("p",{style:{color:"white",margin:0,fontSize:"12px"},children:"小売価格前日比"}),e.jsx("h4",{style:{color:"white",margin:"4px 0"},children:a.change})]},"platinum-change"),e.jsxs("div",{children:[e.jsx("p",{style:{color:"white",margin:0,fontSize:"12px"},children:"店頭買取価格（税込）"}),e.jsx("h4",{style:{color:"white",margin:"4px 0"},children:a.buyPriceFormatted||"取得失敗"})]},"platinum-buy"),e.jsxs("div",{children:[e.jsx("p",{style:{color:"white",margin:0,fontSize:"12px"},children:"買取価格前日比"}),e.jsx("h4",{style:{color:"white",margin:"4px 0"},children:a.buyChangePercent||"0.00%"})]},"platinum-buy-change"),e.jsxs("div",{children:[e.jsx("p",{style:{color:"white",margin:0,fontSize:"12px"},children:"価格調整率"}),e.jsxs("h4",{style:{color:"white",margin:"4px 0"},children:[a.percentage,"%"]})]},"platinum-ratio")]}),e.jsx("div",{style:{marginTop:"12px"},children:e.jsxs("p",{style:{color:"white",margin:0,fontSize:"11px"},children:["出典: ",e.jsx("a",{href:"https://gold.tanaka.co.jp/commodity/souba/d-platinum.php",target:"_blank",rel:"noopener noreferrer",style:{color:"white",textDecoration:"underline"},children:"田中貴金属工業株式会社"})]})}),e.jsxs("p",{style:{color:"white",margin:0,fontSize:"12px"},suppressHydrationWarning:!0,children:["最終更新: ",new Date(a.lastUpdated).toLocaleString("ja-JP")]})]})})}),!a&&e.jsx(je,{tone:"critical",children:"プラチナ価格情報の取得に失敗しました。"})]})]}),!s&&!a&&e.jsx(je,{tone:"critical",children:"金・プラチナ価格情報の取得に失敗しました。価格調整機能をご利用いただけません。"})]}),e.jsx(Te.Section,{children:e.jsx(ve,{children:e.jsxs(fe,{gap:"400",children:[e.jsxs(j,{align:"space-between",children:[e.jsx("h3",{children:"商品検索・選択"}),e.jsx(Se,{icon:Nt,variant:"tertiary",onClick:Oe,loading:T.state==="loading",children:"商品を再読み込み"})]}),e.jsx("div",{children:e.jsxs(W,{variant:"bodySm",tone:"subdued",suppressHydrationWarning:!0,children:["最終更新: ",Ke?Ke.toLocaleString("ja-JP"):"読み込み中...",X&&e.jsx(Y,{tone:"info",size:"small",children:"キャッシュ"})]})}),e.jsxs(j,{gap:"400",children:[e.jsx("div",{style:{minWidth:"180px"},children:e.jsx(ft,{label:"表示する内容",options:[{label:"全ての商品",value:"products"},{label:"全てのコレクション",value:"collections"}],value:M,onChange:ke})}),M==="products"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{flex:1},children:e.jsx(xn,{label:"商品検索",value:le,onChange:Z,placeholder:"商品名またはハンドルで検索...",clearButton:!0,onClearButtonClick:()=>Z("")})}),e.jsx("div",{style:{minWidth:"150px"},children:e.jsx(ft,{label:"商品フィルター",options:[{label:"すべての商品",value:"all"},{label:"K18商品のみ",value:"k18"}],value:$,onChange:Q})})]}),M==="collections"&&e.jsx("div",{style:{minWidth:"200px"},children:e.jsx(W,{variant:"bodySm",tone:"subdued",children:"コレクションを選択して商品を表示"})})]}),e.jsx(xn,{label:"価格下限設定 (%)",type:"number",value:J.toString(),onChange:i=>de(parseInt(i)||93),suffix:"%",helpText:"現在価格に対する最低価格の割合（例: 93% = 7%以上は下がらない）",min:"50",max:"100"}),e.jsxs(fe,{gap:"300",children:[e.jsxs(j,{gap:"300",children:[e.jsx(Se,{onClick:()=>He(!0),disabled:se.length===0,size:"large",children:"すべて選択"},"select-all"),e.jsx(Se,{onClick:()=>He(!1),disabled:E.length===0,size:"large",children:"選択解除"},"deselect-all"),e.jsxs(Se,{onClick:Dt,tone:"critical",disabled:E.filter(i=>Le.has(i.id)).length===0||x.state==="submitting",size:"large",children:["選択中の保存済み ",E.filter(i=>Le.has(i.id)).length," 件を解除"]},"bulk-unselect"),e.jsx(Se,{onClick:Rt,disabled:x.state==="submitting"||E.length===0||E.some(i=>!k[i.id]),variant:"primary",size:"large",children:"選択を保存"},"save-selection")]}),E.length>0&&e.jsx(ve,{children:e.jsxs(fe,{gap:"200",children:[e.jsxs(j,{gap:"300",blockAlign:"center",children:[e.jsxs(W,{variant:"bodyMd",as:"span",children:["新規選択商品(",E.filter(i=>!r.includes(i.id)).length,"件)に一括設定:"]}),e.jsx(Se,{onClick:()=>St("gold"),disabled:E.filter(i=>!r.includes(i.id)).length===0,tone:"warning",children:"🥇 選択した全ての商品を金価格に設定"}),e.jsx(Se,{onClick:()=>St("platinum"),disabled:E.filter(i=>!r.includes(i.id)).length===0,tone:"info",children:"🥈 選択した全ての商品をプラチナ価格に設定"})]}),E.filter(i=>r.includes(i.id)).length>0&&e.jsxs(W,{variant:"bodySm",tone:"subdued",children:["※既に保存済みの",E.filter(i=>r.includes(i.id)).length,"件は一括設定の対象外です"]})]})})]}),E.length>0&&e.jsx(ve,{children:e.jsxs(fe,{gap:"300",children:[e.jsxs(j,{align:"space-between",children:[e.jsxs("h4",{children:["選択中の商品 (",E.length,"件)"]}),e.jsxs(j,{gap:"200",children:[e.jsxs(Y,{tone:"warning",children:["🥇 金: ",E.filter(i=>k[i.id]==="gold").length,"件"]}),e.jsxs(Y,{tone:"info",children:["🥈 プラチナ: ",E.filter(i=>k[i.id]==="platinum").length,"件"]}),e.jsxs(Y,{tone:"critical",children:["⚠️ 未設定: ",E.filter(i=>!k[i.id]).length,"件"]})]})]}),e.jsx(fe,{gap:"200",children:E.map((i,f)=>{const h=k[i.id];return e.jsxs(j,{gap:"200",blockAlign:"center",children:[e.jsx("span",{style:{fontSize:"14px"},children:h==="gold"?"🥇":h==="platinum"?"🥈":"⚠️"}),e.jsx(W,{variant:"bodySm",children:i.title}),h?e.jsx(Y,{tone:h==="gold"?"warning":"info",size:"small",children:h==="gold"?"金価格":"プラチナ価格"}):e.jsx(Y,{tone:"critical",size:"small",children:"金属種別未選択"})]},`selected-${i.id}-${f}`)})}),E.filter(i=>!k[i.id]).length>0&&e.jsxs(je,{tone:"warning",children:[e.jsx("strong",{children:"金属種別未選択の商品があります。"}),"各商品の金属種別（金価格 または プラチナ価格）を選択してから保存してください。"]})]})}),r&&r.length>0&&e.jsxs(je,{tone:"success",children:["現在 ",e.jsxs("strong",{children:[r.length,"件"]})," の商品が自動更新対象として保存されています"]}),((Tt=x.data)==null?void 0:Tt.message)&&e.jsx(je,{tone:"success",children:x.data.message})]})})}),e.jsx(Te.Section,{children:e.jsx(ve,{children:e.jsxs(fe,{gap:"400",children:[e.jsxs(j,{align:"space-between",children:[e.jsx("h3",{children:"手動価格更新"}),e.jsx(Y,{tone:"info",children:"金・プラチナ価格に関係なく手動で価格を調整"})]}),e.jsxs(j,{gap:"400",wrap:!0,children:[e.jsxs("div",{style:{minWidth:"120px"},children:[e.jsx(W,{variant:"bodyMd",as:"p",children:"価格調整方向"}),e.jsxs(j,{gap:"200",blockAlign:"center",children:[e.jsxs("div",{children:[e.jsx("input",{type:"radio",id:"plus",name:"direction",value:"plus",checked:_==="plus",onChange:()=>A("plus")}),e.jsx("label",{htmlFor:"plus",children:"+ 値上げ"})]},"plus-radio"),e.jsxs("div",{children:[e.jsx("input",{type:"radio",id:"minus",name:"direction",value:"minus",checked:_==="minus",onChange:()=>A("minus")}),e.jsx("label",{htmlFor:"minus",children:"- 値下げ"})]},"minus-radio")]})]}),e.jsx("div",{style:{minWidth:"150px"},children:e.jsx(ft,{label:"調整率",options:[{label:"0.1%",value:"0.1"},{label:"0.2%",value:"0.2"},{label:"0.3%",value:"0.3"},{label:"0.4%",value:"0.4"},{label:"0.5%",value:"0.5"},{label:"0.6%",value:"0.6"},{label:"0.7%",value:"0.7"},{label:"0.8%",value:"0.8"},{label:"0.9%",value:"0.9"},{label:"1.0%",value:"1.0"}],value:H.toString(),onChange:i=>Ee(parseFloat(i))})}),e.jsx("div",{children:e.jsxs(W,{variant:"bodyMd",as:"p",tone:"subdued",children:["調整例: ",_==="plus"?"+":"-",H,"% （¥10,000 → ¥",(1e4*(1+(_==="plus"?H:-H)/100)).toLocaleString(),"）"]})})]}),e.jsxs(j,{gap:"300",children:[e.jsx(Se,{onClick:()=>yt(!0),disabled:se.length===0,children:"すべて選択"}),e.jsx(Se,{onClick:()=>yt(!1),disabled:te.length===0,children:"選択解除"}),e.jsx(Se,{onClick:$t,disabled:te.length===0||v.state==="submitting",variant:"primary",tone:"critical",loading:v.state==="submitting",children:v.state==="submitting"?"価格更新中...":`選択商品の価格を手動更新 (${te.length}件)`})]}),te.length>0&&e.jsx(ve,{children:e.jsxs(fe,{gap:"200",children:[e.jsxs(W,{variant:"bodyMd",as:"p",children:["選択中の商品 (",te.length,"件)"]}),e.jsx("div",{style:{maxHeight:"150px",overflowY:"auto"},children:e.jsx(fe,{gap:"100",children:te.map((i,f)=>{const h=t.find(g=>g.id===i);return h?e.jsxs(j,{gap:"200",blockAlign:"center",children:[e.jsx(tt,{checked:!0,onChange:g=>Et(i,g)}),e.jsxs("div",{style:{flex:1},children:[e.jsx(W,{variant:"bodySm",children:h.title}),e.jsx(W,{variant:"caption",tone:"subdued",children:i})]})]},`manual-${i}-${f}`):null})})})]})})]})})}),e.jsx(Te.Section,{children:e.jsxs(ve,{children:[M==="collections"&&((n==null?void 0:n.length)??0)===0&&e.jsx(je,{tone:"info",children:"コレクションが見つかりません。"}),e.jsx("div",{style:{width:"100%",overflowX:"auto",overflowAnchor:"none"},children:e.jsx("div",{style:{minWidth:1680},children:e.jsx(ne,{resourceName:{singular:M==="products"?"商品":"コレクション",plural:M==="products"?"商品":"コレクション"},itemCount:M==="products"?se.length:(n==null?void 0:n.length)||0,selectedItemsCount:E.length,onSelectionChange:i=>{i==="all"?He(!0):i==="none"&&He(!1)},headings:M==="products"?[{title:"選択"},{title:"手動更新"},{title:"商品名"},{title:"ステータス"},{title:"価格"},{title:"バリエーション"},{title:"連動設定"}]:[{title:"選択"},{title:"コレクション名"},{title:"商品数"},{title:"ハンドル"},{title:"連動設定"}],selectable:!1,children:M==="products"?se.map((i,f)=>{var qe;const h=E.some(O=>O.id===i.id),g=i.variants.edges,C=Date.now(),B=g.map(({node:O})=>{const Pe=O.id,ye=ut[Pe];return ye&&ye.until>C?{price:ye.price,status:" (確定)"}:at[Pe]!=null?{price:at[Pe],status:` (更新中${dt>0?` - ${dt}秒後に確認`:""})`}:{price:Math.round(Number(O.price??0)),status:""}}),N=B.map(O=>O.price),q=B.some(O=>O.status!==""),oe=q&&((qe=B.find(O=>O.status!==""))==null?void 0:qe.status)||"",be=B.length>1?`¥${Math.min(...N)} - ¥${Math.max(...N)}${oe}`:`¥${N[0]??0}${oe}`;q&&console.log(`🎯 Special price display for ${i.title}:`,{productId:i.id,variantDisplayPrices:B,finalDisplay:be});const xe=k[i.id],we=Le.has(i.id),ze=k[i.id]??R[i.id]??"none";return e.jsxs(ne.Row,{id:i.id,children:[e.jsx(ne.Cell,{children:e.jsx(K,{minWidth:"60px",maxWidth:"60px",children:e.jsx(tt,{checked:h,onChange:O=>vt(i.id,O)})})}),e.jsx(ne.Cell,{children:e.jsx(K,{minWidth:"80px",maxWidth:"80px",children:e.jsx(tt,{checked:te.includes(i.id),onChange:O=>Et(i.id,O)})})}),e.jsx(ne.Cell,{children:e.jsx(K,{minWidth:"480px",maxWidth:"720px",children:e.jsxs(j,{gap:"200",blockAlign:"center",children:[h&&xe&&e.jsx("span",{style:{fontSize:"16px"},children:xe==="gold"?"🥇":"🥈"}),e.jsx(et,{content:i.title,dismissOnMouseOut:!0,children:e.jsx(W,{as:"span",variant:"bodySm",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",whiteSpace:"normal",wordBreak:"break-word"},children:i.title})}),h&&xe&&e.jsx(Y,{tone:xe==="gold"?"warning":"info",size:"small",children:xe==="gold"?"金":"Pt"}),h&&!xe&&!we&&e.jsx(Y,{tone:"critical",size:"small",children:"未設定"}),we&&e.jsx(Y,{tone:"success",size:"small",children:"保存済"})]})})}),e.jsx(ne.Cell,{children:e.jsx(K,{minWidth:"100px",maxWidth:"120px",children:e.jsx(Y,{status:i.status==="ACTIVE"?"success":"critical",children:i.status})})}),e.jsx(ne.Cell,{children:e.jsx(K,{minWidth:"140px",maxWidth:"200px",children:e.jsx(W,{variant:"bodySm",children:be})})}),e.jsx(ne.Cell,{children:e.jsx(K,{minWidth:"100px",maxWidth:"140px",children:e.jsx(W,{variant:"bodySm",children:g.length})})}),e.jsx(ne.Cell,{children:e.jsx(K,{minWidth:"360px",maxWidth:"420px",children:h||we?e.jsxs("div",{children:[e.jsx(ft,{label:"金属種別",labelHidden:!0,options:[{label:"金属種別を選択...",value:"none",disabled:!0},{label:"🥇 金価格",value:"gold"},{label:"🥈 プラチナ価格",value:"platinum"}],value:ze,onChange:O=>$e(i.id,O),placeholder:"選択してください",disabled:we&&!h}),ze==="none"&&h&&!we&&e.jsx("div",{style:{marginTop:"4px"},children:e.jsx(W,{variant:"bodySm",tone:"critical",children:"※選択が必要です"})}),we&&e.jsx("div",{style:{marginTop:"4px"},children:e.jsxs(j,{gap:"100",blockAlign:"center",children:[e.jsxs(W,{variant:"bodySm",tone:"subdued",children:["保存済み設定",h?"（編集可）":""]}),e.jsx(Mr,{productId:i.id,onOptimistic:O=>{L(Pe=>Pe.filter(ye=>ye.id!==O)),F(Pe=>{const ye={...Pe};return delete ye[O],ye}),Me([O])},scheduleRevalidate:Be})]})})]}):e.jsx(W,{variant:"bodySm",tone:"subdued",children:"-"})})})]},`product-${i.id}-${f}`)}):(n==null?void 0:n.map((i,f)=>{const h=U.includes(i.id),g=Je[i.id]||"none";return e.jsxs(ne.Row,{id:i.id,children:[e.jsx(ne.Cell,{children:e.jsx(K,{minWidth:"60px",maxWidth:"60px",children:e.jsx(tt,{checked:h,onChange:C=>Wt(i.id,C)})})}),e.jsx(ne.Cell,{children:e.jsx(K,{minWidth:"320px",maxWidth:"480px",children:e.jsxs(j,{gap:"200",blockAlign:"center",children:[e.jsx("span",{style:{fontSize:"16px"},children:"📦"}),e.jsx(et,{content:i.title,dismissOnMouseOut:!0,children:e.jsx(W,{variant:"bodyMd",fontWeight:"medium",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",whiteSpace:"normal",wordBreak:"break-word"},children:i.title})}),h&&g&&g!=="none"&&e.jsx(Y,{tone:g==="gold"?"warning":"info",size:"small",children:g==="gold"?"金":"Pt"})]})})}),e.jsx(ne.Cell,{children:e.jsx(K,{minWidth:"120px",maxWidth:"160px",children:e.jsxs(Y,{tone:"info",children:[i.productsCount??"-","件の商品"]})})}),e.jsx(ne.Cell,{children:e.jsx(K,{minWidth:"150px",maxWidth:"200px",children:e.jsx(W,{variant:"bodySm",tone:"subdued",children:i.handle})})}),e.jsx(ne.Cell,{children:e.jsx(K,{minWidth:"280px",maxWidth:"340px",children:h?e.jsx(ft,{label:"金属種別",labelHidden:!0,options:[{label:"金属種別を選択...",value:"none",disabled:!0},{label:"🥇 金価格",value:"gold"},{label:"🥈 プラチナ価格",value:"platinum"}],value:g,onChange:C=>rt(i.id,C),placeholder:"選択してください"}):e.jsx(W,{variant:"bodySm",tone:"subdued",children:"-"})})})]},`collection-${i.id}-${f}`)}))||[]})})})]})}),e.jsx(an,{open:ue,onClose:()=>I(!1),title:"価格調整プレビュー",primaryAction:{content:"価格を更新",onAction:Ot,loading:v.state==="submitting"},secondaryActions:[{content:"キャンセル",onAction:()=>I(!1)}],large:!0,children:e.jsx(an.Section,{children:e.jsx(fe,{gap:"400",children:ie.map((i,f)=>e.jsx(ve,{children:e.jsxs(fe,{gap:"300",children:[e.jsxs(j,{align:"space-between",children:[e.jsx("h4",{children:i.title}),e.jsx(Y,{tone:i.metalType==="gold"?"warning":"info",children:i.metalType==="gold"?"金価格":"プラチナ価格"})]}),i.error?e.jsx(je,{tone:"critical",children:i.error}):i.variants.map((h,g)=>e.jsxs(j,{align:"space-between",children:[e.jsx("span",{children:h.title||"デフォルト"}),e.jsxs(j,{gap:"200",children:[e.jsxs("span",{children:["¥",h.currentPrice," → ¥",h.newPrice]}),h.changed&&e.jsxs(Y,{tone:h.priceChange>0?"warning":"success",children:[h.priceChange>0?"+":"",h.priceChange,"円"]})]})]},`variant-${h.id}-${g}`))]})},`preview-${i.id}-${f}`))})})}),((kt=v.data)==null?void 0:kt.updateResults)&&e.jsx(Te.Section,{children:e.jsx(ve,{children:e.jsxs(fe,{gap:"400",children:[e.jsx("h3",{children:"価格更新結果"}),v.data.summary&&e.jsx(ve,{children:e.jsxs(j,{gap:"400",children:[e.jsxs("div",{children:["合計: ",e.jsx("strong",{children:v.data.summary.total}),"件"]}),e.jsxs("div",{children:["成功: ",e.jsx("strong",{children:v.data.summary.success}),"件"]}),e.jsxs("div",{children:["失敗: ",e.jsx("strong",{children:v.data.summary.failed}),"件"]})]})}),v.data.error&&e.jsx(je,{tone:"critical",children:v.data.error}),v.data.message&&e.jsx(je,{tone:"info",children:v.data.message}),v.data.updateResults.map((i,f)=>{var h,g;return e.jsx(je,{tone:i.success?"success":"critical",children:i.success?`${i.productTitle} ${i.variantTitle?`(${i.variantTitle})`:""}: ¥${(h=i.oldPrice)==null?void 0:h.toLocaleString()} → ¥${(g=i.newPrice)==null?void 0:g.toLocaleString()} ${i.adjustmentRatio?`(${i.adjustmentRatio>0?"+":""}${(i.adjustmentRatio*100).toFixed(1)}%)`:""}`:`Product ${i.productId} / Variant ${i.variantId}: ${i.error}`},`result-${f}-${i.variantId||i.productId}`)})]})})})]})})}function Yr(){const t=aa(),{goldPrice:n,platinumPrice:s,selectedProductIds:a,savedSelectedProducts:r,selectedCollectionIds:l,savedSelectedCollections:p,shopSetting:u,forceRefresh:d,cacheTimestamp:m}=t;return e.jsx(c.Suspense,{fallback:e.jsx(Hn,{fullWidth:!0,title:"商品価格自動調整",subtitle:"読み込み中...",secondaryActions:[{content:"商品を再読み込み",icon:Nt,onAction:()=>{ct.clear(_t.PRODUCTS),window.location.search="?refresh=true"}}],children:e.jsxs(Te,{children:[e.jsx(Te.Section,{children:n&&e.jsx(ve,{children:e.jsxs(fe,{gap:"400",children:[e.jsxs(j,{align:"space-between",children:[e.jsx("h3",{children:"田中貴金属 金価格情報"}),e.jsx(Y,{tone:n.changeDirection==="up"?"attention":n.changeDirection==="down"?"success":"info",children:n.changeDirection==="up"?"上昇":n.changeDirection==="down"?"下落":"変動なし"})]}),e.jsxs(j,{gap:"600",children:[e.jsxs("div",{children:[e.jsx("p",{children:"店頭小売価格（税込）"}),e.jsx("h4",{children:n.retailPriceFormatted})]}),e.jsxs("div",{children:[e.jsx("p",{children:"小売価格前日比"}),e.jsx("h4",{children:n.change})]}),e.jsxs("div",{children:[e.jsx("p",{children:"店頭買取価格（税込）"}),e.jsx("h4",{children:n.buyPriceFormatted||"取得失敗"})]}),e.jsxs("div",{children:[e.jsx("p",{children:"買取価格前日比"}),e.jsx("h4",{children:n.buyChangePercent||"0.00%"})]})]}),e.jsx("div",{children:e.jsxs("p",{children:[e.jsxs("strong",{children:["価格調整率: ",n.percentage,"%"]}),"（この変動率で商品価格を自動調整します）"]})}),e.jsxs("p",{suppressHydrationWarning:!0,children:["最終更新: ",new Date(n.lastUpdated).toLocaleString("ja-JP")]})]})})}),e.jsx(Te.Section,{children:e.jsx(ve,{children:e.jsx(fe,{gap:"400",children:e.jsxs("div",{style:{textAlign:"center",padding:"60px 20px"},children:[e.jsx(ln,{size:"large"}),e.jsx("p",{style:{marginTop:"20px"},children:"商品データを読み込んでいます..."}),e.jsx(W,{variant:"bodySm",tone:"subdued",children:"初回読み込みには時間がかかります。次回からキャッシュにより高速表示されます。"})]})})})})]})}),children:e.jsx(ra,{resolve:Promise.allSettled([t.products,t.collections]),children:([y,x])=>{const v=y.status==="fulfilled"?y.value:[],T=x.status==="fulfilled"?x.value:[];return e.jsx(Wr,{products:v,collections:T,goldPrice:n,platinumPrice:s,selectedProductIds:a,savedSelectedProducts:r,selectedCollectionIds:l,savedSelectedCollections:p,shopSetting:u,forceRefresh:d,cacheTimestamp:m})}})})}export{Yr as default,qr as shouldRevalidate};
